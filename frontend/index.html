<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="NocturneSwap - Professional Solana DEX with real-time trading, liquidity pools, and portfolio management" />
    <title>NocturneSwap - Professional Solana DEX</title>
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="Solana, DEX, DeFi, Swap, Trading, Jupiter, Liquidity, Portfolio" />
    <meta name="author" content="NocturneSwap" />
    <meta property="og:title" content="NocturneSwap - Professional Solana DEX" />
    <meta property="og:description" content="Trade tokens, provide liquidity, and manage your portfolio on Solana" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    
    <!-- Embedded favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåô</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NocturneSwap">
    
    <!-- External APIs -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="src/analytics.js"></script>
    <script src="src/api.js"></script>
    <script src="src/jupiter-integration.js"></script>
    <script src="src/nocturne-integration.js"></script>
    
    <!-- Enhanced Visual Effects -->
    <script src="static/js/advanced-visuals.js"></script>
    
    <!-- Enhanced Stylesheets -->
    <link rel="stylesheet" href="static/css/main-enhanced.css">
    <link rel="stylesheet" href="static/css/mobile-enhancements.css">
    <link rel="stylesheet" href="src/GamingTierFX.css">
    
    <style>
      /* Global Styles - Dark Cult Theme */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: 
          radial-gradient(circle at 20% 80%, rgba(75, 0, 130, 0.15) 0%, transparent 60%),
          radial-gradient(circle at 80% 20%, rgba(139, 0, 139, 0.12) 0%, transparent 60%),
          radial-gradient(circle at 40% 40%, rgba(25, 25, 112, 0.08) 0%, transparent 70%),
          linear-gradient(135deg, #000000 0%, #0a0a0a 25%, #1a0a1a 50%, #0a0a0a 75%, #000000 100%);
        min-height: 100vh;
        color: #e0e0e0;
        overflow-x: hidden;
        position: relative;
        background-attachment: fixed;
      }

      /* Dark Mystical Background Effects */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
          radial-gradient(circle at 25% 25%, rgba(75, 0, 130, 0.08) 0%, transparent 50%),
          radial-gradient(circle at 75% 75%, rgba(139, 0, 139, 0.06) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, rgba(25, 25, 112, 0.04) 0%, transparent 60%);
        pointer-events: none;
        z-index: -1;
        animation: mysticalPulse 12s ease-in-out infinite;
      }

      body::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
          linear-gradient(45deg, transparent 48%, rgba(75, 0, 130, 0.02) 50%, transparent 52%),
          linear-gradient(-45deg, transparent 48%, rgba(139, 0, 139, 0.02) 50%, transparent 52%);
        pointer-events: none;
        z-index: -1;
        animation: mysticalGrid 20s linear infinite;
      }

      @keyframes mysticalPulse {
        0%, 100% { opacity: 0.4; }
        33% { opacity: 0.7; }
        66% { opacity: 0.5; }
      }

      @keyframes mysticalGrid {
        0% { transform: translate(0, 0) rotate(0deg); }
        100% { transform: translate(50px, 50px) rotate(360deg); }
      }
      
      /* Loading Screen - Dark Cult */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
          radial-gradient(circle at center, rgba(75, 0, 130, 0.4) 0%, transparent 70%),
          linear-gradient(135deg, #000000 0%, #050505 25%, #0a0a0a 50%, #050505 75%, #000000 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #e0e0e0;
        z-index: 9999;
        backdrop-filter: blur(2px);
      }
      
      .loading-spinner {
        width: 80px;
        height: 80px;
        border: 4px solid rgba(75, 0, 130, 0.2);
        border-top: 4px solid #9d4edd;
        border-right: 4px solid #7209b7;
        border-bottom: 4px solid #6a0dad;
        border-radius: 50%;
        animation: cultSpin 2s linear infinite;
        margin-bottom: 20px;
        box-shadow: 
          0 0 20px rgba(75, 0, 130, 0.4),
          0 0 40px rgba(139, 0, 139, 0.2),
          inset 0 0 20px rgba(75, 0, 130, 0.1);
        position: relative;
      }

      .loading-spinner::before {
        content: '';
        position: absolute;
        top: -8px;
        left: -8px;
        right: -8px;
        bottom: -8px;
        border: 2px solid transparent;
        border-top: 2px solid rgba(139, 0, 139, 0.3);
        border-radius: 50%;
        animation: cultSpin 3s linear infinite reverse;
      }
      
      @keyframes cultSpin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .loading-text {
        font-size: 1.8rem;
        margin-bottom: 10px;
        text-shadow: 
          0 0 10px rgba(75, 0, 130, 0.8),
          0 0 20px rgba(139, 0, 139, 0.4),
          0 0 30px rgba(25, 25, 112, 0.2);
        animation: textGlow 3s ease-in-out infinite;
      }

      @keyframes textGlow {
        0%, 100% { text-shadow: 0 0 10px rgba(75, 0, 130, 0.8), 0 0 20px rgba(139, 0, 139, 0.4); }
        50% { text-shadow: 0 0 15px rgba(75, 0, 130, 1), 0 0 25px rgba(139, 0, 139, 0.6), 0 0 35px rgba(25, 25, 112, 0.4); }
      }
      
      .loading-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        text-shadow: 0 0 5px rgba(75, 0, 130, 0.5);
      }
      
      /* Enhanced Loading Progress */
      .loading-progress {
        margin-top: 30px;
        width: 300px;
        text-align: center;
      }
      
      .progress-bar {
        width: 100%;
        height: 4px;
        background: rgba(75, 0, 130, 0.2);
        border-radius: 2px;
        overflow: hidden;
        margin-bottom: 10px;
        box-shadow: 0 0 10px rgba(75, 0, 130, 0.3);
      }
      
      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, 
          rgba(75, 0, 130, 0.8), 
          rgba(139, 0, 139, 0.8), 
          rgba(255, 140, 0, 0.8));
        border-radius: 2px;
        width: 0%;
        transition: width 0.3s ease;
        animation: progressGlow 2s ease-in-out infinite;
      }
      
      @keyframes progressGlow {
        0%, 100% { box-shadow: 0 0 5px rgba(75, 0, 130, 0.5); }
        50% { box-shadow: 0 0 15px rgba(139, 0, 139, 0.8); }
      }
      
      .progress-text {
        font-size: 0.9rem;
        color: #c0c0c0;
        text-shadow: 0 0 5px rgba(75, 0, 130, 0.3);
      }
      
      /* Main App Container */
      .app-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        display: none;
      }
      
      /* Header - Dark Cult Style */
      .header {
        text-align: center;
        margin-bottom: 40px;
        color: #e0e0e0;
        position: relative;
        padding: 20px 0;
      }
      
      .header::before {
        content: '‚üê ‚óÜ ‚üê ‚óÜ ‚üê';
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.8rem;
        color: #9d4edd;
        opacity: 0.7;
        animation: runeFloat 4s ease-in-out infinite;
        text-shadow: 0 0 15px rgba(75, 0, 130, 0.8);
      }

      .header::after {
        content: '‚óá ‚üê ‚óá ‚üê ‚óá';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.8rem;
        color: #7209b7;
        opacity: 0.7;
        animation: runeFloat 4s ease-in-out infinite reverse;
        text-shadow: 0 0 15px rgba(139, 0, 139, 0.8);
      }

      @keyframes runeFloat {
        0%, 100% { transform: translateX(-50%) translateY(0px); opacity: 0.7; }
        50% { transform: translateX(-50%) translateY(-8px); opacity: 1; }
      }
      
      .header h1 {
        font-size: 3.5rem;
        margin-bottom: 15px;
        background: linear-gradient(45deg, #e0e0e0 0%, #9d4edd 25%, #7209b7 50%, #6a0dad 75%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 30px rgba(75, 0, 130, 0.5);
        position: relative;
        font-weight: 700;
        letter-spacing: 2px;
        animation: titleGlow 6s ease-in-out infinite;
      }

      @keyframes titleGlow {
        0%, 100% { 
          filter: drop-shadow(0 0 10px rgba(75, 0, 130, 0.5)); 
          transform: scale(1);
        }
        50% { 
          filter: drop-shadow(0 0 20px rgba(139, 0, 139, 0.8)); 
          transform: scale(1.02);
        }
      }

      .header h1::before {
        content: '‚òæ';
        position: absolute;
        left: -80px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2.5rem;
        color: #9d4edd;
        text-shadow: 0 0 20px rgba(75, 0, 130, 0.9);
        animation: moonPhase 8s ease-in-out infinite;
      }

      .header h1::after {
        content: '‚òΩ';
        position: absolute;
        right: -80px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2.5rem;
        color: #7209b7;
        text-shadow: 0 0 20px rgba(139, 0, 139, 0.9);
        animation: moonPhase 8s ease-in-out infinite reverse;
      }

      @keyframes moonPhase {
        0%, 100% { opacity: 0.6; transform: translateY(-50%) rotate(0deg); }
        50% { opacity: 1; transform: translateY(-50%) rotate(15deg); }
      }
      
      .header p {
        font-size: 1.3rem;
        opacity: 0.9;
        color: #c0c0c0;
        text-shadow: 0 0 10px rgba(75, 0, 130, 0.3);
        margin-top: 10px;
        font-weight: 300;
        letter-spacing: 1px;
      }
      
      /* Navigation */
      .navigation {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 40px;
        flex-wrap: wrap;
        position: relative;
      }

      .navigation::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, rgba(75, 0, 130, 0.3), transparent);
        z-index: -1;
      }
      
      .nav-button {
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(20, 20, 20, 0.6)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.1), rgba(139, 0, 139, 0.05));
        color: #e0e0e0;
        border: 1px solid rgba(75, 0, 130, 0.3);
        border-radius: 12px;
        padding: 14px 28px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        display: inline-block;
        backdrop-filter: blur(15px);
        position: relative;
        overflow: hidden;
        text-shadow: 0 0 10px rgba(75, 0, 130, 0.3);
        box-shadow: 
          0 4px 15px rgba(0, 0, 0, 0.3),
          0 0 20px rgba(75, 0, 130, 0.1),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
      }

      .nav-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(75, 0, 130, 0.2), transparent);
        transition: left 0.5s ease;
      }

      .nav-button:hover::before {
        left: 100%;
      }

      .nav-button:hover {
        background: 
          linear-gradient(145deg, rgba(75, 0, 130, 0.2), rgba(139, 0, 139, 0.1)),
          linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 20, 0.7));
        border-color: rgba(75, 0, 130, 0.6);
        transform: translateY(-2px);
        box-shadow: 
          0 8px 25px rgba(0, 0, 0, 0.4),
          0 0 30px rgba(75, 0, 130, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.2);
        color: #ffffff;
        text-shadow: 0 0 15px rgba(75, 0, 130, 0.8);
      }

      .nav-button.active {
        background: 
          linear-gradient(145deg, rgba(75, 0, 130, 0.3), rgba(139, 0, 139, 0.2)),
          linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 20, 0.8));
        border-color: rgba(75, 0, 130, 0.8);
        color: #ffffff;
        text-shadow: 0 0 20px rgba(75, 0, 130, 1);
        box-shadow: 
          0 0 20px rgba(75, 0, 130, 0.4),
          inset 0 0 10px rgba(75, 0, 130, 0.2);
      }
      
      /* Main Content Area */
      .main-content {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 30px;
        margin-bottom: 30px;
      }
      
      /* Swap Container */
      .swap-container {
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(15, 15, 15, 0.8)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.1), rgba(139, 0, 139, 0.05));
        border: 1px solid rgba(75, 0, 130, 0.3);
        border-radius: 25px;
        padding: 35px;
        box-shadow: 
          0 25px 50px rgba(0, 0, 0, 0.5),
          0 0 30px rgba(75, 0, 130, 0.15),
          inset 0 1px 0 rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        position: relative;
        overflow: hidden;
      }

      .swap-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, 
          transparent, 
          rgba(75, 0, 130, 0.8), 
          rgba(139, 0, 139, 0.6), 
          rgba(75, 0, 130, 0.8), 
          transparent);
        animation: borderGlow 4s ease-in-out infinite;
      }

      @keyframes borderGlow {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
      }
      
      .swap-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      
      .swap-title {
        font-size: 1.6rem;
        font-weight: 700;
        color: #e0e0e0;
        text-shadow: 0 0 15px rgba(75, 0, 130, 0.4);
        position: relative;
      }

      .swap-title::before {
        content: '‚óÜ';
        position: absolute;
        left: -25px;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(75, 0, 130, 0.7);
        font-size: 1.2rem;
        animation: pulseGem 3s ease-in-out infinite;
      }

      @keyframes pulseGem {
        0%, 100% { opacity: 0.5; transform: translateY(-50%) scale(1); }
        50% { opacity: 1; transform: translateY(-50%) scale(1.1); }
      }
      
      .settings-btn {
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(15, 15, 15, 0.6)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.1), rgba(139, 0, 139, 0.05));
        border: 1px solid rgba(75, 0, 130, 0.3);
        border-radius: 12px;
        padding: 10px 16px;
        cursor: pointer;
        font-size: 1rem;
        color: #e0e0e0;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }
      
      .settings-btn:hover {
        background: 
          linear-gradient(145deg, rgba(75, 0, 130, 0.2), rgba(139, 0, 139, 0.1)),
          linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(15, 15, 15, 0.7));
        border-color: rgba(75, 0, 130, 0.5);
        transform: translateY(-1px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }
      
      /* Token Input */
      .token-input {
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(15, 15, 15, 0.6)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.08), rgba(139, 0, 139, 0.04));
        border: 1px solid rgba(75, 0, 130, 0.2);
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 15px;
        position: relative;
        backdrop-filter: blur(15px);
        box-shadow: 
          0 8px 20px rgba(0, 0, 0, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.03);
        transition: all 0.3s ease;
      }

      .token-input:hover {
        border-color: rgba(75, 0, 130, 0.4);
        box-shadow: 
          0 12px 25px rgba(0, 0, 0, 0.4),
          0 0 20px rgba(75, 0, 130, 0.1),
          inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      
      .token-input.error {
        border-color: #dc3545;
        box-shadow: 
          0 8px 20px rgba(0, 0, 0, 0.3),
          0 0 15px rgba(220, 53, 69, 0.3);
      }
      
      .token-label {
        font-size: 0.95rem;
        color: #c0c0c0;
        margin-bottom: 12px;
        display: block;
        font-weight: 500;
        text-shadow: 0 0 5px rgba(75, 0, 130, 0.2);
      }
      
      .token-input-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
      }
      
      .token-input-row input {
        background: transparent;
        border: none;
        outline: none;
        font-size: 1.5rem;
        font-weight: 600;
        color: #333;
        flex: 1;
        min-width: 0;
      }
      
      .token-select {
        background: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
        flex-shrink: 0;
        min-width: 80px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      
      .token-select:hover {
        background: #0056b3;
        transform: translateY(-1px);
      }
      
      .token-balance {
        font-size: 0.8rem;
        color: #666;
        margin-top: 5px;
      }
      
      /* Swap Arrow */
      .swap-arrow {
        display: flex;
        justify-content: center;
        margin: 10px 0;
      }
      
      .swap-icon {
        width: 40px;
        height: 40px;
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 1.2rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      
      .swap-icon:hover {
        transform: rotate(180deg);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      
      /* Swap Details */
      .swap-details {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 15px;
        margin: 20px 0;
      }
      
      .detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 0.9rem;
      }
      
      .detail-row:last-child {
        margin-bottom: 0;
      }
      
      .detail-label {
        color: #666;
      }
      
      .detail-value {
        font-weight: 600;
        color: #333;
      }
      
      .detail-value.positive {
        color: #28a745;
      }
      
      .detail-value.negative {
        color: #dc3545;
      }
      
      /* Swap Button */
      .swap-button {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        border-radius: 12px;
        padding: 16px 32px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
        position: relative;
        overflow: hidden;
      }
      
      .swap-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      }
      
      .swap-button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }
      
      .swap-button.loading {
        color: transparent;
      }
      
      .swap-button.loading::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin: -10px 0 0 -10px;
        border: 2px solid transparent;
        border-top: 2px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      /* Sidebar */
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      
      .sidebar-card {
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.85), rgba(15, 15, 15, 0.75)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.08), rgba(139, 0, 139, 0.05));
        border: 1px solid rgba(75, 0, 130, 0.2);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 
          0 15px 35px rgba(0, 0, 0, 0.4),
          0 0 20px rgba(75, 0, 130, 0.1),
          inset 0 1px 0 rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .sidebar-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, transparent, rgba(75, 0, 130, 0.5), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .sidebar-card:hover::before {
        opacity: 1;
      }

      .sidebar-card:hover {
        transform: translateY(-2px);
        box-shadow: 
          0 20px 40px rgba(0, 0, 0, 0.5),
          0 0 30px rgba(75, 0, 130, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
        border-color: rgba(75, 0, 130, 0.4);
      }
      
      .sidebar-card h3 {
        margin-bottom: 20px;
        color: #e0e0e0;
        font-size: 1.3rem;
        font-weight: 600;
        text-shadow: 0 0 10px rgba(75, 0, 130, 0.3);
        position: relative;
        padding-bottom: 10px;
      }

      .sidebar-card h3::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 40px;
        height: 2px;
        background: linear-gradient(90deg, rgba(75, 0, 130, 0.8), transparent);
      }
      
      /* Wallet Card */
      .wallet-status {
        text-align: center;
        padding: 20px;
      }
      
      .wallet-connect-btn {
        background: 
          linear-gradient(145deg, rgba(75, 0, 130, 0.8), rgba(139, 0, 139, 0.6)),
          linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 20, 0.8));
        color: #ffffff;
        border: 1px solid rgba(75, 0, 130, 0.4);
        border-radius: 12px;
        padding: 14px 28px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        margin: 8px;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        text-shadow: 0 0 10px rgba(75, 0, 130, 0.5);
        box-shadow: 
          0 4px 15px rgba(0, 0, 0, 0.3),
          0 0 20px rgba(75, 0, 130, 0.2);
        position: relative;
        overflow: hidden;
      }

      .wallet-connect-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s ease;
      }

      .wallet-connect-btn:hover::before {
        left: 100%;
      }
      
      .wallet-connect-btn:hover {
        transform: translateY(-3px);
        box-shadow: 
          0 8px 25px rgba(0, 0, 0, 0.4),
          0 0 30px rgba(75, 0, 130, 0.4);
        border-color: rgba(75, 0, 130, 0.6);
        text-shadow: 0 0 15px rgba(75, 0, 130, 0.8);
      }

      .wallet-connect-btn:active {
        transform: translateY(-1px);
      }
      
      .wallet-info {
        display: none;
        text-align: left;
      }
      
      .wallet-address {
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        background: 
          linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(15, 15, 15, 0.6)),
          linear-gradient(145deg, rgba(75, 0, 130, 0.1), rgba(139, 0, 139, 0.05));
        color: #c0c0c0;
        padding: 12px 16px;
        border-radius: 10px;
        margin: 15px 0;
        word-break: break-all;
        border: 1px solid rgba(75, 0, 130, 0.2);
        box-shadow: 
          inset 0 2px 4px rgba(0, 0, 0, 0.3),
          0 0 10px rgba(75, 0, 130, 0.1);
        text-shadow: 0 0 5px rgba(75, 0, 130, 0.3);
        position: relative;
      }

      .wallet-address::before {
        content: '‚óÜ';
        position: absolute;
        left: -5px;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(75, 0, 130, 0.6);
        font-size: 0.8rem;
      }
      
      .balance-item {
        display: flex;
        justify-content: space-between;
        margin: 8px 0;
        padding: 8px;
        background: #f8f9fa;
        border-radius: 6px;
      }
      
      /* Market Stats */
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      
      .stat-item {
        text-align: center;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
      }
      
      .stat-value {
        font-size: 1.2rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 4px;
      }
      
      .stat-label {
        font-size: 0.8rem;
        color: #666;
      }
      
      /* Recent Trades */
      .trade-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        margin: 8px 0;
        background: #f8f9fa;
        border-radius: 8px;
        font-size: 0.9rem;
      }
      
      .trade-pair {
        font-weight: 600;
        color: #333;
      }
      
      .trade-amount {
        color: #666;
      }
      
      .trade-time {
        color: #999;
        font-size: 0.8rem;
      }
      
      /* Pool Interface */
      .pool-interface {
        display: none;
      }
      
      .pool-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }
      
      .pool-stat {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
      }
      
      .pool-stat-value {
        font-size: 1.1rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
      }
      
      .pool-stat-label {
        font-size: 0.9rem;
        color: #666;
      }
      
      /* Admin Interface */
      .admin-interface {
        display: none;
      }
      
      .admin-controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }
      
      .admin-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
      }
      
      .admin-card h4 {
        margin-bottom: 10px;
        color: #333;
      }
      
      .admin-btn {
        background: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.2s;
        width: 100%;
      }
      
      .admin-btn:hover {
        background: #0056b3;
        transform: translateY(-1px);
      }
      
      .admin-btn.danger {
        background: #dc3545;
      }
      
      .admin-btn.danger:hover {
        background: #c82333;
      }
      
      /* Trading History Styles */
      .trade-entry {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        margin: 8px 0;
        background: white;
        border-radius: 8px;
        border: 1px solid #e9ecef;
        transition: all 0.2s;
      }
      
      .trade-entry:hover {
        background: #f8f9fa;
        transform: translateY(-1px);
      }
      
      .trade-pair {
        font-weight: 600;
        color: #333;
      }
      
      .trade-amount {
        color: #007bff;
        font-weight: 500;
      }
      
      .trade-time {
        color: #666;
        font-size: 0.9rem;
      }
      
      .portfolio-stats {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      
      /* Mobile Responsive */
      @media (max-width: 768px) {
        .main-content {
          grid-template-columns: 1fr;
        }
        
        .sidebar {
          order: -1;
        }
        
        .header h1 {
          font-size: 2rem;
        }
        
        .swap-container {
          padding: 20px;
        }
        
        .token-input-row {
          flex-direction: column;
          align-items: stretch;
          gap: 10px;
        }
        
        .token-input-row input {
          text-align: center;
          padding: 10px;
          background: white;
          border: 1px solid #e9ecef;
          border-radius: 8px;
        }
        
        .token-select {
          width: 100%;
          justify-content: center;
        }
        
        .navigation {
          flex-direction: column;
          align-items: center;
        }
        
        .nav-button {
          width: 200px;
          text-align: center;
        }
      }
      
      @media (max-width: 480px) {
        .app-container {
          padding: 10px;
        }
        
        .swap-container {
          padding: 15px;
        }
        
        .sidebar-card {
          padding: 15px;
        }
      }
      
      /* --- Gaming-Tier Visual Effects --- */
      :root {
        --theme-cult-bg: #18122b;
        --theme-cult-primary: #ff1493;
        --theme-cult-accent: #8e44ad;
        --theme-cult-fog: #fff0fa44;
        --theme-cyber-bg: #0a0f1a;
        --theme-cyber-primary: #00fff7;
        --theme-cyber-accent: #00ff85;
        --theme-cyber-fog: #00fff744;
        --theme-ember-bg: #1a0a0a;
        --theme-ember-primary: #ff6f00;
        --theme-ember-accent: #ff1744;
        --theme-ember-fog: #ffb30044;
      }
      body.theme-cult {
        background: linear-gradient(120deg, var(--theme-cult-bg) 80%, #2d1436 100%);
        color: var(--theme-cult-primary);
      }
      body.theme-cyber {
        background: linear-gradient(120deg, var(--theme-cyber-bg) 80%, #001f2d 100%);
        color: var(--theme-cyber-primary);
      }
      body.theme-ember {
        background: linear-gradient(120deg, var(--theme-ember-bg) 80%, #2d1a14 100%);
        color: var(--theme-ember-primary);
      }
      /* Runic Borders */
      .rune-corners {
        position: relative;
      }
      .rune-corners::before, .rune-corners::after {
        content: '';
        position: absolute;
        width: 32px; height: 32px;
        border: 2px solid var(--theme-primary, #ff1493);
        border-radius: 8px;
        pointer-events: none;
        opacity: 0.7;
      }
      .rune-corners::before { top: -8px; left: -8px; border-right: none; border-bottom: none; }
      .rune-corners::after { bottom: -8px; right: -8px; border-left: none; border-top: none; }
      /* Fog Layer */
      .fog-layer {
        pointer-events: none;
        position: fixed;
        left: 0; top: 0; width: 100vw; height: 100vh;
        z-index: 1;
        background: radial-gradient(ellipse at 50% 60%, var(--theme-cult-fog, #fff0fa44) 0%, transparent 80%);
        opacity: 0.5;
        transition: background 0.5s;
      }
      body.theme-cyber .fog-layer { background: radial-gradient(ellipse at 50% 60%, var(--theme-cyber-fog, #00fff744) 0%, transparent 80%); }
      body.theme-ember .fog-layer { background: radial-gradient(ellipse at 50% 60%, var(--theme-ember-fog, #ffb30044) 0%, transparent 80%); }
      /* Embers/Particles */
      .ember {
        position: fixed;
        pointer-events: none;
        z-index: 2;
        width: 8px; height: 8px;
        border-radius: 50%;
        background: radial-gradient(circle, #ffb300 0%, #ff1744 100%);
        opacity: 0.7;
        animation: ember-float 6s linear infinite;
      }
      @keyframes ember-float {
        0% { transform: translateY(0) scale(1); opacity: 0.7; }
        80% { opacity: 1; }
        100% { transform: translateY(-120vh) scale(0.5); opacity: 0; }
      }
      /* Enhanced Buttons */
      .theme-btn, .floating-btn, .glow-btn {
        border: 2px solid var(--theme-primary, #ff1493);
        background: rgba(20,20,20,0.7);
        color: var(--theme-primary, #ff1493);
        border-radius: 8px;
        box-shadow: 0 0 8px var(--theme-primary, #ff1493), 0 0 2px #000;
        transition: background 0.2s, color 0.2s, box-shadow 0.2s;
      }
      .theme-btn.active, .floating-btn.active, .glow-btn.active {
        background: var(--theme-primary, #ff1493);
        color: #fff;
        box-shadow: 0 0 16px var(--theme-primary, #ff1493);
      }
      /* XP Bar Animation */
      .xp-bar-fill {
        background: linear-gradient(90deg, var(--theme-primary, #ff1493), var(--theme-accent, #8e44ad));
      }
      
      .theme-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: rgba(0, 0, 0, 0.95);
        border: 1px solid var(--neon-pink, #ff1493);
        border-radius: 8px;
        padding: 8px;
        display: none;
        min-width: 120px;
        backdrop-filter: blur(15px);
        z-index: 1000;
      }
      
      .theme-dropdown.show {
        display: block;
      }
      
      .theme-option {
        display: block;
        width: 100%;
        background: transparent;
        border: none;
        color: white;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: left;
      }
      
      .theme-option:hover {
        background: rgba(255, 20, 147, 0.2);
        color: var(--neon-pink, #ff1493);
      }
      
      /* Floating Action Buttons */
      .floating-buttons {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 1000;
      }
      
      .floating-toggle {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--neon-pink, #ff1493), #ff69b4);
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 
          0 4px 20px rgba(255, 20, 147, 0.4),
          0 0 20px rgba(255, 20, 147, 0.6);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .floating-toggle:hover {
        transform: scale(1.1);
        box-shadow: 
          0 6px 25px rgba(255, 20, 147, 0.6),
          0 0 30px rgba(255, 20, 147, 0.8);
      }
      
      .floating-menu {
        position: absolute;
        bottom: 70px;
        right: 0;
        display: flex;
        flex-direction: column;
        gap: 10px;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
        pointer-events: none;
      }
      
      .floating-menu.show {
        opacity: 1;
        transform: translateY(0);
        pointer-events: all;
      }
      
      .floating-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid var(--neon-pink, #ff1493);
        color: white;
        font-size: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .floating-btn:hover {
        background: rgba(255, 20, 147, 0.2);
        transform: scale(1.1);
        box-shadow: 0 0 15px var(--neon-pink, #ff1493);
      }
      
      /* Theme Classes */
      .theme-cult {
        --theme-primary: #ff1493;
        --theme-secondary: #ff69b4;
        --theme-glow: #ff1493;
        --theme-bg: #0a0a0a;
      }
      
      .theme-cyber {
        --theme-primary: #00ffff;
        --theme-secondary: #0080ff;
        --theme-glow: #00ffff;
        --theme-bg: #001122;
      }
      
      .theme-ember {
        --theme-primary: #ff6600;
        --theme-secondary: #ff9900;
        --theme-glow: #ff6600;
        --theme-bg: #2a1a0a;
      }
      
      /* Responsive Design */
      @media (max-width: 768px) {
        .header-top {
          flex-direction: column;
          align-items: stretch;
        }
        
        .xp-rank-bar {
          min-width: auto;
        }
        
        .floating-buttons {
          bottom: 20px;
          right: 20px;
        }
        
        .floating-toggle {
          width: 50px;
          height: 50px;
          font-size: 20px;
        }
        
        .floating-btn {
          width: 40px;
          height: 40px;
          font-size: 16px;
        }
      }
      
      /* Level Up Animation */
      @keyframes levelUpPulse {
        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
        50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      }
      
      /* Achievements Modal */
      .achievements-modal .modal-content {
        background: rgba(0, 0, 0, 0.95);
        border: 2px solid var(--theme-primary, #ff1493);
        border-radius: 15px;
        padding: 0;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        backdrop-filter: blur(20px);
      }
      
      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid var(--theme-primary, #ff1493);
      }
      
      .modal-header h2 {
        color: var(--theme-primary, #ff1493);
        margin: 0;
        text-shadow: 0 0 10px var(--theme-primary, #ff1493);
      }
      
      .modal-close {
        background: none;
        border: none;
        color: #fff;
        font-size: 24px;
        cursor: pointer;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }
      
      .modal-close:hover {
        background: rgba(255, 20, 147, 0.2);
        color: var(--theme-primary, #ff1493);
      }
      
      .modal-body {
        padding: 20px;
      }
      
      .achievement-grid {
        display: grid;
        gap: 15px;
      }
      
      .achievement-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }
      
      .achievement-item.completed {
        border-color: var(--theme-primary, #ff1493);
        box-shadow: 0 0 10px rgba(255, 20, 147, 0.3);
      }
      
      .achievement-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
      }
      
      .achievement-icon {
        font-size: 24px;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 20, 147, 0.2);
        border-radius: 50%;
        border: 1px solid var(--theme-primary, #ff1493);
      }
      
      .achievement-info h3 {
        margin: 0 0 5px 0;
        color: var(--theme-primary, #ff1493);
        font-size: 16px;
      }
      
      .achievement-info p {
        margin: 0;
        color: #ccc;
        font-size: 14px;
      }
      
      /* Achievement Modal Styles */
      .achievement-modal .modal-content {
        background: linear-gradient(135deg, #1a1a2e, #16213e);
        border: 2px solid var(--neon-pink, #ff1493);
        border-radius: 15px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
      }
      
      .achievement-modal .close {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 30px;
        color: #fff;
        cursor: pointer;
        line-height: 1;
      }
      
      .achievement-grid {
        display: grid;
        gap: 15px;
        margin-top: 20px;
      }
      
      .achievement-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        border: 1px solid #333;
        border-radius: 10px;
        transition: all 0.3s ease;
        opacity: 0.5;
      }
      
      .achievement-item.unlocked {
        opacity: 1;
        border-color: var(--neon-pink, #ff1493);
        background: rgba(255, 20, 147, 0.1);
        box-shadow: 0 0 15px rgba(255, 20, 147, 0.3);
      }
      
      .achievement-icon {
        font-size: 30px;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
      }
      
      .achievement-text h4 {
        margin: 0 0 5px 0;
        color: var(--neon-pink, #ff1493);
      }
      
      .achievement-text p {
        margin: 0;
        color: #ccc;
        font-size: 14px;
      }
      
      /* Rank Up Animation */
      @keyframes rankUpPulse {
        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
        50% { transform: translate(-50%, -50%) scale(1.1); }
        100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      }
      
      /* Social Features Styles */
      .profile-info {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
      }
      
      .profile-avatar {
        position: relative;
      }
      
      .avatar-circle {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--neon-pink, #ff1493), var(--neon-purple, #8e44ad));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
      }
      
      .rank-badge {
        position: absolute;
        bottom: -5px;
        right: -5px;
        background: var(--neon-pink, #ff1493);
        color: white;
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 10px;
        font-weight: bold;
      }
      
      .profile-stats {
        flex: 1;
      }
      
      .stat-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
      }
      
      .stat-label {
        color: #ccc;
      }
      
      .stat-value {
        color: var(--neon-pink, #ff1493);
        font-weight: bold;
      }
      
      /* Referral System */
      .referral-section {
        margin-top: 10px;
      }
      
      .referral-stats {
        margin-bottom: 15px;
      }
      
      .stat-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        color: #ccc;
      }
      
      .referral-link {
        display: flex;
        gap: 10px;
      }
      
      .referral-link input {
        flex: 1;
        padding: 8px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--neon-pink, #ff1493);
        border-radius: 4px;
        color: white;
        font-size: 12px;
      }
      
      /* Leaderboard */
      .leaderboard {
        margin-top: 10px;
      }
      
      .leaderboard-entry {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px;
        margin-bottom: 5px;
        border-radius: 4px;
        background: rgba(255, 255, 255, 0.05);
      }
      
      .leaderboard-entry.top-rank {
        background: linear-gradient(45deg, rgba(255, 215, 0, 0.2), rgba(255, 20, 147, 0.2));
        border: 1px solid rgba(255, 215, 0, 0.5);
      }
      
      .leaderboard-entry.current-user {
        background: rgba(255, 20, 147, 0.2);
        border: 1px solid var(--neon-pink, #ff1493);
      }
      
      .leaderboard-entry .rank {
        font-size: 14px;
        min-width: 30px;
      }
      
      .leaderboard-entry .username {
        flex: 1;
        color: white;
      }
      
      .leaderboard-entry .score {
        color: var(--neon-pink, #ff1493);
        font-weight: bold;
        font-size: 12px;
      }
      
      /* Social Feed */
      .social-feed {
        margin-top: 10px;
        max-height: 200px;
        overflow-y: auto;
      }
      
      .feed-item {
        display: flex;
        gap: 10px;
        padding: 8px;
        margin-bottom: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 4px;
      }
      
      .feed-avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: var(--neon-pink, #ff1493);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
      }
      
      .feed-content {
        flex: 1;
      }
      
      .feed-user {
        font-weight: bold;
        color: var(--neon-pink, #ff1493);
        font-size: 12px;
      }
      
      .feed-text {
        color: white;
        font-size: 12px;
        margin: 2px 0;
      }
      
      .feed-time {
        color: #999;
        font-size: 10px;
      }
      
      /* DAO Governance Styles */
      .voting-power {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
      }
      
      .power-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: conic-gradient(var(--neon-pink, #ff1493), var(--neon-purple, #8e44ad), var(--neon-pink, #ff1493));
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
      }
      
      .power-value {
        font-size: 20px;
        font-weight: bold;
      }
      
      .power-label {
        font-size: 10px;
        opacity: 0.8;
      }
      
      .power-breakdown {
        flex: 1;
      }
      
      .power-source {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 12px;
        color: #ccc;
      }
      
      /* Proposals */
      .proposals-list {
        margin-top: 10px;
        max-height: 300px;
        overflow-y: auto;
      }
      
      .proposal-item {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 20, 147, 0.3);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
      }
      
      .proposal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      
      .proposal-title {
        font-weight: bold;
        color: white;
        font-size: 14px;
      }
      
      .proposal-status {
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 10px;
        font-weight: bold;
      }
      
      .proposal-status.active {
        background: var(--neon-pink, #ff1493);
        color: white;
      }
      
      .proposal-description {
        color: #ccc;
        font-size: 12px;
        margin-bottom: 10px;
      }
      
      .vote-progress {
        margin-bottom: 10px;
      }
      
      .vote-bar {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 5px;
      }
      
      .vote-fill {
        height: 100%;
        background: var(--neon-pink, #ff1493);
        transition: width 0.3s ease;
      }
      
      .vote-fill.yes {
        background: #4caf50;
      }
      
      .vote-counts {
        display: flex;
        justify-content: space-between;
        font-size: 10px;
      }
      
      .yes-votes {
        color: #4caf50;
      }
      
      .no-votes {
        color: #f44336;
      }
      
      .proposal-time {
        color: #999;
        font-size: 10px;
        margin-bottom: 10px;
      }
      
      .proposal-actions {
        display: flex;
        gap: 10px;
      }
      
      .vote-btn {
        padding: 6px 12px;
        border: none;
        border-radius: 4px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .vote-btn.yes {
        background: #4caf50;
        color: white;
      }
      
      .vote-btn.no {
        background: #f44336;
        color: white;
      }
      
      .vote-btn:hover {
        opacity: 0.8;
        transform: translateY(-1px);
      }
      
      /* Proposal Form */
      .proposal-form {
        margin-top: 10px;
      }
      
      .proposal-form input,
      .proposal-form textarea {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 20, 147, 0.3);
        border-radius: 4px;
        color: white;
        font-size: 12px;
      }
      
      .proposal-form textarea {
        resize: vertical;
        min-height: 60px;
      }
      
      .form-note {
        font-size: 10px;
        color: #999;
        margin-top: 5px;
      }
      
      /* Advanced Trading Features */
      .trading-modes {
        margin: 15px 0;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 15px;
      }
      
      .mode-tabs {
        display: flex;
        gap: 5px;
        margin-bottom: 15px;
      }
      
      .mode-tab {
        flex: 1;
        padding: 8px 12px;
        background: transparent;
        border: 1px solid rgba(255, 20, 147, 0.3);
        color: #ccc;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s ease;
      }
      
      .mode-tab.active {
        background: var(--neon-pink, #ff1493);
        color: white;
        border-color: var(--neon-pink, #ff1493);
      }
      
      .trading-panel {
        margin-top: 10px;
      }
      
      .limit-controls, .dca-controls {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }
      
      .limit-input-group, .dca-input-group {
        flex: 1;
      }
      
      .limit-label, .dca-label {
        display: block;
        font-size: 10px;
        color: #ccc;
        margin-bottom: 5px;
      }
      
      .limit-input-group input, .dca-input-group select {
        width: 100%;
        padding: 6px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 20, 147, 0.3);
        border-radius: 4px;
        color: white;
        font-size: 12px;
      }
      
      .price-unit {
        font-size: 10px;
        color: #ccc;
        margin-left: 5px;
      }
      
      .limit-info, .dca-preview {
        margin-top: 10px;
        padding: 8px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 4px;
      }
      
      .dca-stat {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 12px;
        color: #ccc;
      }
      
      /* Advanced Portfolio Analytics */
      .portfolio-value-display {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .current-value {
        font-size: 24px;
        font-weight: bold;
        color: var(--neon-pink, #ff1493);
      }
      
      .value-change {
        font-size: 14px;
        padding: 2px 6px;
        border-radius: 4px;
      }
      
      .value-change.positive {
        background: rgba(76, 175, 80, 0.2);
        color: #4caf50;
      }
      
      .value-change.negative {
        background: rgba(244, 67, 54, 0.2);
        color: #f44336;
      }
      
      .performance-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }
      
      .performance-item {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
      }
      
      .metric-label {
        color: #ccc;
      }
      
      .metric-value {
        font-weight: bold;
        color: white;
      }
      
      .metric-value.positive {
        color: #4caf50;
      }
      
      .holdings-list {
        margin-top: 10px;
      }
      
      .holding-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
      }
      
      .holding-token {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .token-icon {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: var(--neon-pink, #ff1493);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
      }
      
      .token-name {
        font-weight: bold;
        color: white;
      }
      
      .token-amount {
        font-size: 12px;
        color: #ccc;
      }
      
      .holding-value {
        text-align: right;
      }
      
      .value-usd {
        font-weight: bold;
        color: white;
      }
      
      .trade-filters {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }
      
      .trade-filters select {
        padding: 4px 8px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 20, 147, 0.3);
        border-radius: 4px;
        color: white;
        font-size: 11px;
      }
      
      .trade-entry.advanced {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
      }
      
      .trade-info {
        flex: 1;
      }
      
      .trade-type {
        font-size: 10px;
        color: #ccc;
      }
      
      .trade-amounts {
        flex: 1;
        text-align: center;
      }
      
      .trade-value {
        font-size: 11px;
        color: #ccc;
      }
      
      .trade-meta {
        flex: 1;
        text-align: right;
      }
      
      .trade-pnl {
        font-weight: bold;
        font-size: 12px;
      }
      
      .trade-pnl.positive {
        color: #4caf50;
      }
      
      .trade-pnl.negative {
        color: #f44336;
      }
      
      /* Enhanced Admin Dashboard */
      .analytics-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }
      
      .analytics-item {
        text-align: center;
        padding: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
      }
      
      .analytics-value {
        font-size: 18px;
        font-weight: bold;
        color: var(--neon-pink, #ff1493);
      }
      
      .analytics-label {
        font-size: 10px;
        color: #ccc;
        margin-top: 5px;
      }
      
      .analytics-change {
        font-size: 9px;
        font-weight: bold;
        margin-top: 2px;
      }
      
      .analytics-change.positive {
        color: #4caf50;
      }
      
      .analytics-change.negative {
        color: #f44336;
      }
      
      /* Seasonal Events */
      .events-management {
        margin-top: 10px;
      }
      
      .current-event {
        padding: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
        margin-bottom: 15px;
      }
      
      .event-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      
      .event-name {
        font-weight: bold;
        color: white;
      }
      
      .event-status.active {
        background: #4caf50;
        color: white;
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 10px;
      }
      
      .event-progress {
        margin-bottom: 10px;
      }
      
      .progress-bar {
        width: 100%;
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
        overflow: hidden;
        margin-bottom: 5px;
      }
      
      .progress-fill {
        height: 100%;
        background: var(--neon-pink, #ff1493);
        transition: width 0.3s ease;
      }
      
      .progress-text {
        font-size: 10px;
        color: #ccc;
      }
      
      .event-rewards {
        display: flex;
        gap: 10px;
        font-size: 11px;
        color: #ccc;
        margin-bottom: 10px;
      }
      
      .event-actions {
        display: flex;
        gap: 5px;
      }
      
      .admin-btn.small {
        padding: 4px 8px;
        font-size: 10px;
      }
      
      .event-creator {
        padding: 10px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 6px;
      }
      
      .event-creator h5 {
        margin: 0 0 10px 0;
        color: white;
      }
      
      .event-creator input, .event-creator select {
        width: 100%;
        padding: 6px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 20, 147, 0.3);
        border-radius: 4px;
        color: white;
        font-size: 12px;
      }
      
      /* System Controls */
      .system-controls {
        margin-top: 10px;
      }
      
      .control-group {
        margin-bottom: 15px;
        padding: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
      }
      
      .control-group h5 {
        margin: 0 0 10px 0;
        color: white;
        font-size: 12px;
      }
      
      .status-display {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
      }
      
      .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #4caf50;
      }
      
      .uptime {
        font-size: 10px;
        color: #ccc;
        margin-left: auto;
      }
      
      .feature-toggles {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      
      .toggle-switch {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
      }
      
      .toggle-slider {
        position: relative;
        width: 30px;
        height: 16px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 16px;
        transition: background 0.3s ease;
      }
      
      .toggle-slider::before {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 12px;
        height: 12px;
        background: white;
        border-radius: 50%;
        transition: transform 0.3s ease;
      }
      
      .toggle-switch input:checked + .toggle-slider {
        background: var(--neon-pink, #ff1493);
      }
      
      .toggle-switch input:checked + .toggle-slider::before {
        transform: translateX(14px);
      }
      
      .toggle-label {
        font-size: 11px;
        color: white;
      }
      
      .data-controls {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      
      .danger-zone {
        border: 1px solid rgba(244, 67, 54, 0.3);
        background: rgba(244, 67, 54, 0.1);
      }
      
      /* Cult Wars */
      .cult-wars {
        margin-top: 10px;
      }
      
      .current-battle {
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        margin-bottom: 15px;
      }
      
      .battle-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }
      
      .battle-title {
        font-weight: bold;
        color: white;
        font-size: 14px;
      }
      
      .battle-timer {
        background: var(--neon-pink, #ff1493);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: bold;
      }
      
      .battle-teams {
        margin-bottom: 15px;
      }
      
      .team {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 6px;
        padding: 10px;
        margin-bottom: 8px;
      }
      
      .team-name {
        font-weight: bold;
        margin-bottom: 8px;
      }
      
      .team.moon-cult .team-name {
        color: #ff1493;
      }
      
      .team.degen-army .team-name {
        color: #00ff85;
      }
      
      .team-progress {
        margin-bottom: 5px;
      }
      
      .team-bar {
        height: 8px;
        margin-bottom: 5px;
      }
      
      .progress-fill.moon {
        background: linear-gradient(90deg, #ff1493, #8e44ad);
      }
      
      .progress-fill.degen {
        background: linear-gradient(90deg, #00ff85, #00fff7);
      }
      
      .team-score {
        font-weight: bold;
        font-size: 12px;
      }
      
      .team-members {
        font-size: 10px;
        color: #ccc;
      }
      
      .vs-divider {
        text-align: center;
        font-weight: bold;
        color: var(--neon-pink, #ff1493);
        margin: 10px 0;
      }
      
      .battle-rewards {
        margin-bottom: 15px;
      }
      
      .battle-rewards h5 {
        margin: 0 0 10px 0;
        color: white;
        font-size: 12px;
      }
      
      .rewards-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }
      
      .reward-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 8px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 4px;
      }
      
      .reward-icon {
        font-size: 16px;
        margin-bottom: 4px;
      }
      
      .reward-text {
        font-size: 9px;
        text-align: center;
        color: #ccc;
      }
      
      .your-contribution {
        padding: 10px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 6px;
      }
      
      .your-contribution h5 {
        margin: 0 0 10px 0;
        color: white;
        font-size: 12px;
      }
      
      .contribution-stats {
        margin-bottom: 10px;
      }
      
      .contrib-stat {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 11px;
      }
      
      .contrib-label {
        color: #ccc;
      }
      
      .contrib-value {
        color: white;
        font-weight: bold;
      }
      
      .cult-btn {
        background: linear-gradient(45deg, #ff1493, #8e44ad);
        border: none;
        color: white;
      }
    </style>
  </head>
  <body>
    <!-- Loading Screen with Matrix Effect -->
    <div class="loading-screen" id="loadingScreen">
      <div class="mystical-loader"></div>
      <div class="loading-text holo-text">üåô Loading NocturneSwap</div>
      <div class="loading-subtitle matrix-text">Initializing mystical DEX interface...</div>
      <div class="loading-progress">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">Connecting to the void...</div>
      </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
      <header class="header">
        <div class="header-top">
          <!-- XP & Rank Bar -->
          <div class="xp-rank-bar">
            <div class="cult-rank" id="cultRank">Initiate</div>
            <div class="xp-progress">
              <div class="xp-bar-bg">
                <div class="xp-bar-fill" id="xpBarFill" style="width: 0%"></div>
              </div>
              <span class="xp-text" id="xpText">0 / 100 XP</span>
            </div>
            <div class="level-indicator" id="levelIndicator">Level 1</div>
          </div>
          
          <!-- Theme Switcher -->
          <div class="theme-controls">
            <button class="theme-btn" id="themeBtn" data-theme="cult">üåô Cult</button>
            <div class="theme-dropdown" id="themeDropdown">
              <button class="theme-option" data-theme="cult">üåô Cult</button>
              <button class="theme-option" data-theme="cyber">‚ö° Cyber</button>
              <button class="theme-option" data-theme="ember">üî• Ember</button>
            </div>
          </div>
        </div>
        
        <h1>üåô NocturneSwap</h1>
        <p>Professional Solana DEX - Trade ‚Ä¢ Pool ‚Ä¢ Earn</p>
      </header>
      
      <nav class="navigation" role="navigation" aria-label="Main navigation">
        <button class="nav-button active" data-section="swap" aria-pressed="true">üí± Swap</button>
        <button class="nav-button" data-section="pools" aria-pressed="false">üèä Pools</button>
        <button class="nav-button" data-section="portfolio" aria-pressed="false">üìä Portfolio</button>
        <button class="nav-button" data-section="social" aria-pressed="false">üë• Social</button>
        <button class="nav-button" data-section="dao" aria-pressed="false">üèõÔ∏è DAO</button>
        <button class="nav-button" data-section="admin" aria-pressed="false">‚öôÔ∏è Admin</button>
      </nav>
      
      <!-- Floating Action Buttons -->
      <div class="floating-buttons" id="floatingButtons">
        <button class="floating-toggle" id="floatingToggle">‚ú®</button>
        <div class="floating-menu" id="floatingMenu">
          <button class="floating-btn" id="securityBtn" title="Security Scan">üõ°Ô∏è</button>
          <button class="floating-btn" id="achievementsBtn" title="Achievements">üèÜ</button>
          <button class="floating-btn" id="settingsBtn" title="Settings">‚öôÔ∏è</button>
          <button class="floating-btn" id="helpBtn" title="Help">‚ùì</button>
        </div>
      </div>
      
      <main class="main-content" role="main">
        <!-- Swap Interface -->
        <div class="swap-container" id="swapInterface">
          <div class="swap-header">
            <h2 class="swap-title">Token Swap</h2>
            <button class="settings-btn" id="settingsBtn">‚öôÔ∏è</button>
          </div>
          
          <div class="token-input" id="fromTokenInput">
            <label class="token-label">From</label>
            <div class="token-input-row">
              <input type="number" placeholder="0.0" id="fromAmount" step="0.000001" />
              <button class="token-select" id="fromTokenSelect">
                <span>SOL</span>
                <span>‚ñº</span>
              </button>
            </div>
            <div class="token-balance" id="fromBalance">Balance: --</div>
          </div>
          
          <div class="swap-arrow">
            <div class="swap-icon" id="swapIcon">‚áÖ</div>
          </div>
          
          <div class="token-input" id="toTokenInput">
            <label class="token-label">To</label>
            <div class="token-input-row">
              <input type="number" placeholder="0.0" id="toAmount" readonly />
              <button class="token-select" id="toTokenSelect">
                <span>USDC</span>
                <span>‚ñº</span>
              </button>
            </div>
            <div class="token-balance" id="toBalance">Balance: --</div>
          </div>
          
          <div class="swap-details" id="swapDetails">
            <div class="detail-row">
              <span class="detail-label">Rate</span>
              <span class="detail-value" id="exchangeRate">--</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Price Impact</span>
              <span class="detail-value" id="priceImpact">--</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Minimum Received</span>
              <span class="detail-value" id="minReceived">--</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Fee</span>
              <span class="detail-value" id="tradingFee">~0.3%</span>
            </div>
          </div>
          
          <!-- Advanced Trading Features -->
          <div class="trading-modes" id="tradingModes">
            <div class="mode-tabs">
              <button class="mode-tab active" data-mode="instant">‚ö° Instant</button>
              <button class="mode-tab" data-mode="limit">üìä Limit</button>
              <button class="mode-tab" data-mode="dca">üîÑ DCA</button>
            </div>
            
            <!-- Limit Order Panel -->
            <div class="trading-panel" id="limitPanel" style="display: none;">
              <div class="limit-controls">
                <div class="limit-input-group">
                  <label class="limit-label">Target Price</label>
                  <input type="number" id="limitPrice" placeholder="0.0" step="0.000001" />
                  <span class="price-unit">USDC</span>
                </div>
                <div class="limit-input-group">
                  <label class="limit-label">Expires In</label>
                  <select id="limitExpiry">
                    <option value="1h">1 Hour</option>
                    <option value="24h">24 Hours</option>
                    <option value="7d">7 Days</option>
                    <option value="30d">30 Days</option>
                  </select>
                </div>
              </div>
              <div class="limit-info">
                <span class="limit-status" id="limitStatus">Set your target price</span>
              </div>
            </div>
            
            <!-- DCA Panel -->
            <div class="trading-panel" id="dcaPanel" style="display: none;">
              <div class="dca-controls">
                <div class="dca-input-group">
                  <label class="dca-label">Frequency</label>
                  <select id="dcaFrequency">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                  </select>
                </div>
                <div class="dca-input-group">
                  <label class="dca-label">Duration</label>
                  <select id="dcaDuration">
                    <option value="1w">1 Week</option>
                    <option value="1m">1 Month</option>
                    <option value="3m">3 Months</option>
                    <option value="6m">6 Months</option>
                  </select>
                </div>
              </div>
              <div class="dca-preview">
                <div class="dca-stat">
                  <span>Total Purchases:</span>
                  <span id="dcaTotalPurchases">--</span>
                </div>
                <div class="dca-stat">
                  <span>Amount per Purchase:</span>
                  <span id="dcaAmountPerPurchase">--</span>
                </div>
              </div>
            </div>
          </div>
          
          <button class="swap-button" id="swapButton" disabled>
            Connect Wallet
          </button>
        </div>
        
        <!-- Sidebar -->
        <div class="sidebar">
          <!-- Wallet Card -->
          <div class="sidebar-card">
            <h3>üîó Wallet</h3>
            <div class="wallet-status" id="walletStatus">
              <button class="wallet-connect-btn" id="connectPhantom">
                üëª Phantom
              </button>
              <button class="wallet-connect-btn" id="connectSolflare">
                üåü Solflare
              </button>
              
              <div class="wallet-info" id="walletInfo">
                <div><strong>Connected:</strong> <span id="walletName">--</span></div>
                <div class="wallet-address" id="walletAddress">--</div>
                <div class="balance-item">
                  <span>SOL</span>
                  <span id="solBalance">--</span>
                </div>
                <div class="balance-item">
                  <span>USDC</span>
                  <span id="usdcBalance">--</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Market Stats -->
          <div class="sidebar-card">
            <h3>üìà Market Stats</h3>
            <div class="stats-grid">
              <div class="stat-item">
                <div class="stat-value" id="totalVolume">$--</div>
                <div class="stat-label">24h Volume</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="totalLiquidity">$--</div>
                <div class="stat-label">Total Liquidity</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="totalUsers">--</div>
                <div class="stat-label">Active Users</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="totalTrades">--</div>
                <div class="stat-label">Total Trades</div>
              </div>
            </div>
          </div>
          
          <!-- Recent Trades -->
          <div class="sidebar-card">
            <h3>üîÑ Recent Trades</h3>
            <div id="recentTrades">
              <div class="trade-item">
                <div>
                  <div class="trade-pair">SOL/USDC</div>
                  <div class="trade-amount">12.5 SOL</div>
                </div>
                <div class="trade-time">2m ago</div>
              </div>
              <div class="trade-item">
                <div>
                  <div class="trade-pair">USDC/USDT</div>
                  <div class="trade-amount">1,250 USDC</div>
                </div>
                <div class="trade-time">5m ago</div>
              </div>
              <div class="trade-item">
                <div>
                  <div class="trade-pair">RAY/SOL</div>
                  <div class="trade-amount">85 RAY</div>
                </div>
                <div class="trade-time">8m ago</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Pool Interface -->
      <div class="pool-interface" id="poolInterface">
        <div class="sidebar-card">
          <h3>üèä Liquidity Pools</h3>
          <div class="pool-stats">
            <div class="pool-stat">
              <div class="pool-stat-value" id="poolCount">--</div>
              <div class="pool-stat-label">Active Pools</div>
            </div>
            <div class="pool-stat">
              <div class="pool-stat-value" id="poolTVL">$--</div>
              <div class="pool-stat-label">Total TVL</div>
            </div>
            <div class="pool-stat">
              <div class="pool-stat-value" id="poolAPY">--%</div>
              <div class="pool-stat-label">Average APY</div>
            </div>
          </div>
          <p>üöß Pool creation and management coming soon!</p>
        </div>
      </div>
      
      <!-- Portfolio Interface -->
      <div class="admin-interface" id="portfolioInterface">
        <div class="sidebar-card">
          <h3>üìä Advanced Portfolio Analytics</h3>
          
          <!-- Portfolio Overview -->
          <div class="portfolio-stats">
            <div class="admin-card">
              <h4>üí∞ Portfolio Value</h4>
              <div class="portfolio-value-display">
                <div class="current-value" id="portfolioValue">$--</div>
                <div class="value-change" id="portfolioChange">--</div>
              </div>
            </div>
            
            <div class="admin-card">
              <h4>üìà Performance Metrics</h4>
              <div class="performance-grid">
                <div class="performance-item">
                  <span class="metric-label">Total Return:</span>
                  <span class="metric-value positive" id="totalReturn">+$--</span>
                </div>
                <div class="performance-item">
                  <span class="metric-label">Win Rate:</span>
                  <span class="metric-value" id="winRate">--%</span>
                </div>
                <div class="performance-item">
                  <span class="metric-label">Avg Trade Size:</span>
                  <span class="metric-value" id="avgTradeSize">$--</span>
                </div>
                <div class="performance-item">
                  <span class="metric-label">Best Trade:</span>
                  <span class="metric-value positive" id="bestTrade">+$--</span>
                </div>
              </div>
            </div>
            
            <!-- Holdings Breakdown -->
            <div class="admin-card">
              <h4>ü™ô Token Holdings</h4>
              <div class="holdings-list">
                <div class="holding-item">
                  <div class="holding-token">
                    <div class="token-icon">‚óé</div>
                    <div class="token-info">
                      <div class="token-name">SOL</div>
                      <div class="token-amount">0.00 SOL</div>
                    </div>
                  </div>
                  <div class="holding-value">
                    <div class="value-usd">$0.00</div>
                    <div class="value-change">+0.00%</div>
                  </div>
                </div>
                <div class="holding-item">
                  <div class="holding-token">
                    <div class="token-icon">$</div>
                    <div class="token-info">
                      <div class="token-name">USDC</div>
                      <div class="token-amount">0.00 USDC</div>
                    </div>
                  </div>
                  <div class="holding-value">
                    <div class="value-usd">$0.00</div>
                    <div class="value-change">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Trading History with Advanced Filters -->
            <div class="admin-card">
              <h4>üìä Trading History</h4>
              <div class="trade-filters">
                <select id="timeFilter">
                  <option value="24h">Last 24 Hours</option>
                  <option value="7d">Last 7 Days</option>
                  <option value="30d">Last 30 Days</option>
                  <option value="all">All Time</option>
                </select>
                <select id="typeFilter">
                  <option value="all">All Trades</option>
                  <option value="swaps">Swaps Only</option>
                  <option value="limits">Limit Orders</option>
                  <option value="dca">DCA Orders</option>
                </select>
              </div>
              <div id="tradingHistory">
                <div class="trade-entry advanced">
                  <div class="trade-info">
                    <div class="trade-pair">SOL ‚Üí USDC</div>
                    <div class="trade-type">Instant Swap</div>
                  </div>
                  <div class="trade-amounts">
                    <div class="trade-amount">1.5 SOL</div>
                    <div class="trade-value">$150.75</div>
                  </div>
                  <div class="trade-meta">
                    <div class="trade-pnl positive">+$2.50</div>
                    <div class="trade-time">2 mins ago</div>
                  </div>
                </div>
                <div class="trade-entry advanced">
                  <div class="trade-info">
                    <div class="trade-pair">USDC ‚Üí RAY</div>
                    <div class="trade-type">Limit Order</div>
                  </div>
                  <div class="trade-amounts">
                    <div class="trade-amount">50 USDC</div>
                    <div class="trade-value">125 RAY</div>
                  </div>
                  <div class="trade-meta">
                    <div class="trade-pnl negative">-$1.20</div>
                    <div class="trade-time">15 mins ago</div>
                  </div>
                </div>
              </div>
              <button class="admin-btn" id="exportTrades">Export CSV</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Admin Interface -->
      <div class="admin-interface" id="adminInterface">
        <div class="sidebar-card">
          <h3>‚öôÔ∏è Enhanced Admin Dashboard</h3>
          
          <!-- Real-time Analytics -->
          <div class="admin-controls">
            <div class="admin-card">
              <h4>üìä Live Analytics</h4>
              <div class="analytics-grid">
                <div class="analytics-item">
                  <div class="analytics-value" id="totalUsers">1,247</div>
                  <div class="analytics-label">Total Users</div>
                  <div class="analytics-change positive">+12 today</div>
                </div>
                <div class="analytics-item">
                  <div class="analytics-value" id="totalVolume">$847K</div>
                  <div class="analytics-label">24h Volume</div>
                  <div class="analytics-change positive">+15.3%</div>
                </div>
                <div class="analytics-item">
                  <div class="analytics-value" id="totalTrades">5,239</div>
                  <div class="analytics-label">Total Trades</div>
                  <div class="analytics-change positive">+89 today</div>
                </div>
                <div class="analytics-item">
                  <div class="analytics-value" id="avgTradeSize">$162</div>
                  <div class="analytics-label">Avg Trade</div>
                  <div class="analytics-change negative">-2.1%</div>
                </div>
              </div>
            </div>
            
            <!-- Seasonal Events Management -->
            <div class="admin-card">
              <h4>üéÉ Seasonal Events</h4>
              <div class="events-management">
                <div class="current-event">
                  <div class="event-header">
                    <span class="event-name">Halloween Trading Frenzy</span>
                    <span class="event-status active">ACTIVE</span>
                  </div>
                  <div class="event-details">
                    <div class="event-progress">
                      <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%"></div>
                      </div>
                      <span class="progress-text">65% Complete</span>
                    </div>
                    <div class="event-rewards">
                      <span>Bonus XP: 2x</span>
                      <span>Special NFT: üéÉ</span>
                    </div>
                  </div>
                  <div class="event-actions">
                    <button class="admin-btn small" id="editEvent">Edit</button>
                    <button class="admin-btn small danger" id="endEvent">End</button>
                  </div>
                </div>
                
                <div class="event-creator">
                  <h5>Create New Event</h5>
                  <input type="text" placeholder="Event Name" id="eventName" />
                  <select id="eventType">
                    <option value="xp_boost">XP Boost</option>
                    <option value="trading_contest">Trading Contest</option>
                    <option value="special_nft">Special NFT Drop</option>
                    <option value="fee_reduction">Fee Reduction</option>
                  </select>
                  <input type="number" placeholder="Duration (hours)" id="eventDuration" />
                  <button class="admin-btn" id="createEvent">Create Event</button>
                </div>
              </div>
            </div>
            
            <!-- Advanced System Controls -->
            <div class="admin-card">
              <h4>üîß System Controls</h4>
              <div class="system-controls">
                <div class="control-group">
                  <h5>Server Status</h5>
                  <div class="status-display">
                    <span class="status-indicator online" id="serverStatus"></span>
                    <span id="systemStatus">üü¢ Online</span>
                    <span class="uptime" id="uptime">99.8% uptime</span>
                  </div>
                  <button class="admin-btn" id="refreshStatus">Refresh Status</button>
                </div>
                
                <div class="control-group">
                  <h5>Feature Toggles</h5>
                  <div class="feature-toggles">
                    <label class="toggle-switch">
                      <input type="checkbox" id="limitOrdersToggle" checked />
                      <span class="toggle-slider"></span>
                      <span class="toggle-label">Limit Orders</span>
                    </label>
                    <label class="toggle-switch">
                      <input type="checkbox" id="dcaToggle" checked />
                      <span class="toggle-slider"></span>
                      <span class="toggle-label">DCA Trading</span>
                    </label>
                    <label class="toggle-switch">
                      <input type="checkbox" id="socialFeedToggle" checked />
                      <span class="toggle-slider"></span>
                      <span class="toggle-label">Social Feed</span>
                    </label>
                  </div>
                </div>
                
                <div class="control-group">
                  <h5>Data Management</h5>
                  <div class="data-controls">
                    <button class="admin-btn" id="exportData">üìä Export Analytics</button>
                    <button class="admin-btn" id="exportUsers">üë• Export Users</button>
                    <button class="admin-btn" id="backupData">üíæ Backup Data</button>
                  </div>
                </div>
                
                <div class="control-group danger-zone">
                  <h5>‚ö†Ô∏è Danger Zone</h5>
                  <button class="admin-btn danger" id="maintenanceMode">üöß Maintenance Mode</button>
                  <button class="admin-btn danger" id="emergencyStop">üõë Emergency Stop</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Social Features Interface -->
      <div class="social-interface" id="socialInterface" style="display: none;">
        <div class="sidebar-card">
          <h3>üë• Social Hub</h3>
          
          <!-- User Profile -->
          <div class="admin-card">
            <h4>üåô Cult Profile</h4>
            <div class="profile-info">
              <div class="profile-avatar">
                <div class="avatar-circle" id="userAvatar">üåô</div>
                <div class="rank-badge" id="userRankBadge">Rank 1</div>
              </div>
              <div class="profile-stats">
                <div class="stat-item">
                  <span class="stat-label">XP:</span>
                  <span class="stat-value" id="profileXP">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Trades:</span>
                  <span class="stat-value" id="profileTrades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Volume:</span>
                  <span class="stat-value" id="profileVolume">$0</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Referral System -->
          <div class="admin-card">
            <h4>üîó Referral System</h4>
            <div class="referral-section">
              <div class="referral-stats">
                <div class="stat-row">
                  <span>Referred Users:</span>
                  <span id="referralCount">0</span>
                </div>
                <div class="stat-row">
                  <span>Bonus XP Earned:</span>
                  <span id="referralBonus">0</span>
                </div>
              </div>
              <div class="referral-link">
                <input type="text" id="referralLink" readonly value="https://nocturneswap.com?ref=CULT001" />
                <button class="admin-btn" id="copyReferralLink">Copy</button>
              </div>
            </div>
          </div>
          
          <!-- Leaderboard -->
          <div class="admin-card">
            <h4>üèÜ Cult Leaderboard</h4>
            <div class="leaderboard">
              <div class="leaderboard-entry top-rank">
                <span class="rank">ü•á</span>
                <span class="username">CultMaster</span>
                <span class="score">2,450 XP</span>
              </div>
              <div class="leaderboard-entry">
                <span class="rank">ü•à</span>
                <span class="username">MoonTrader</span>
                <span class="score">1,890 XP</span>
              </div>
              <div class="leaderboard-entry">
                <span class="rank">ü•â</span>
                <span class="username">DegenKing</span>
                <span class="score">1,650 XP</span>
              </div>
              <div class="leaderboard-entry current-user">
                <span class="rank">#47</span>
                <span class="username">You</span>
                <span class="score" id="leaderboardUserXP">0 XP</span>
              </div>
            </div>
          </div>
          
          <!-- Social Feed -->
          <div class="admin-card">
            <h4>üì¢ Cult Activity</h4>
            <div class="social-feed">
              <div class="feed-item">
                <div class="feed-avatar">üåô</div>
                <div class="feed-content">
                  <div class="feed-user">CultMaster</div>
                  <div class="feed-text">Just swapped 10 SOL! üöÄ</div>
                  <div class="feed-time">2 mins ago</div>
                </div>
              </div>
              <div class="feed-item">
                <div class="feed-avatar">‚≠ê</div>
                <div class="feed-content">
                  <div class="feed-user">MoonTrader</div>
                  <div class="feed-text">Reached Rank 5! üëë</div>
                  <div class="feed-time">5 mins ago</div>
                </div>
              </div>
              <div class="feed-item">
                <div class="feed-avatar">üíé</div>
                <div class="feed-content">
                  <div class="feed-user">DegenKing</div>
                  <div class="feed-text">New achievement unlocked!</div>
                  <div class="feed-time">10 mins ago</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Cult Wars - Competitive Feature -->
          <div class="admin-card">
            <h4>‚öîÔ∏è Cult Wars</h4>
            <div class="cult-wars">
              <div class="current-battle">
                <div class="battle-header">
                  <span class="battle-title">Weekly Trading Battle</span>
                  <span class="battle-timer" id="battleTimer">2d 14h left</span>
                </div>
                <div class="battle-teams">
                  <div class="team moon-cult">
                    <div class="team-name">üåô Moon Cult</div>
                    <div class="team-progress">
                      <div class="progress-bar team-bar">
                        <div class="progress-fill moon" style="width: 65%"></div>
                      </div>
                      <span class="team-score">$2.4M Volume</span>
                    </div>
                    <div class="team-members">847 members</div>
                  </div>
                  <div class="vs-divider">VS</div>
                  <div class="team degen-army">
                    <div class="team-name">ü¶ç Degen Army</div>
                    <div class="team-progress">
                      <div class="progress-bar team-bar">
                        <div class="progress-fill degen" style="width: 58%"></div>
                      </div>
                      <span class="team-score">$2.1M Volume</span>
                    </div>
                    <div class="team-members">723 members</div>
                  </div>
                </div>
                <div class="battle-rewards">
                  <h5>üèÜ Battle Rewards</h5>
                  <div class="rewards-grid">
                    <div class="reward-item">
                      <span class="reward-icon">üëë</span>
                      <span class="reward-text">Exclusive Badge</span>
                    </div>
                    <div class="reward-item">
                      <span class="reward-icon">üíé</span>
                      <span class="reward-text">2x XP Weekend</span>
                    </div>
                    <div class="reward-item">
                      <span class="reward-icon">üéÅ</span>
                      <span class="reward-text">Mystery NFT</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="your-contribution">
                <h5>Your Contribution</h5>
                <div class="contribution-stats">
                  <div class="contrib-stat">
                    <span class="contrib-label">Team:</span>
                    <span class="contrib-value">üåô Moon Cult</span>
                  </div>
                  <div class="contrib-stat">
                    <span class="contrib-label">Volume:</span>
                    <span class="contrib-value" id="userBattleVolume">$0</span>
                  </div>
                  <div class="contrib-stat">
                    <span class="contrib-label">Rank:</span>
                    <span class="contrib-value" id="userBattleRank">#--</span>
                  </div>
                </div>
                <button class="admin-btn cult-btn" id="switchTeam">Switch Team</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- DAO Governance Interface -->
      <div class="dao-interface" id="daoInterface" style="display: none;">
        <div class="sidebar-card">
          <h3>üèõÔ∏è DAO Governance</h3>
          
          <!-- Voting Power -->
          <div class="admin-card">
            <h4>‚ö° Your Voting Power</h4>
            <div class="voting-power">
              <div class="power-circle">
                <div class="power-value" id="votingPower">0</div>
                <div class="power-label">Votes</div>
              </div>
              <div class="power-breakdown">
                <div class="power-source">
                  <span>Token Holdings:</span>
                  <span id="tokenVotes">0</span>
                </div>
                <div class="power-source">
                  <span>Cult Rank Bonus:</span>
                  <span id="rankVotes">0</span>
                </div>
                <div class="power-source">
                  <span>Activity Bonus:</span>
                  <span id="activityVotes">0</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Active Proposals -->
          <div class="admin-card">
            <h4>üìã Active Proposals</h4>
            <div class="proposals-list">
              <div class="proposal-item">
                <div class="proposal-header">
                  <div class="proposal-title">Reduce Trading Fees</div>
                  <div class="proposal-status active">Active</div>
                </div>
                <div class="proposal-description">Proposal to reduce trading fees from 0.3% to 0.25%</div>
                <div class="proposal-stats">
                  <div class="vote-progress">
                    <div class="vote-bar">
                      <div class="vote-fill yes" style="width: 65%"></div>
                    </div>
                    <div class="vote-counts">
                      <span class="yes-votes">üëç 65% (1,250 votes)</span>
                      <span class="no-votes">üëé 35% (675 votes)</span>
                    </div>
                  </div>
                  <div class="proposal-time">2 days left</div>
                </div>
                <div class="proposal-actions">
                  <button class="vote-btn yes" onclick="castVote('prop1', 'yes')">Vote Yes</button>
                  <button class="vote-btn no" onclick="castVote('prop1', 'no')">Vote No</button>
                </div>
              </div>
              
              <div class="proposal-item">
                <div class="proposal-header">
                  <div class="proposal-title">Add New Token Pairs</div>
                  <div class="proposal-status active">Active</div>
                </div>
                <div class="proposal-description">Add support for BONK, WIF, and PEPE trading pairs</div>
                <div class="proposal-stats">
                  <div class="vote-progress">
                    <div class="vote-bar">
                      <div class="vote-fill yes" style="width: 78%"></div>
                    </div>
                    <div class="vote-counts">
                      <span class="yes-votes">üëç 78% (1,890 votes)</span>
                      <span class="no-votes">üëé 22% (532 votes)</span>
                    </div>
                  </div>
                  <div class="proposal-time">5 days left</div>
                </div>
                <div class="proposal-actions">
                  <button class="vote-btn yes" onclick="castVote('prop2', 'yes')">Vote Yes</button>
                  <button class="vote-btn no" onclick="castVote('prop2', 'no')">Vote No</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Create Proposal -->
          <div class="admin-card">
            <h4>‚úçÔ∏è Create Proposal</h4>
            <div class="proposal-form">
              <input type="text" placeholder="Proposal Title" id="proposalTitle" />
              <textarea placeholder="Proposal Description" id="proposalDescription" rows="3"></textarea>
              <button class="admin-btn" id="createProposal">Submit Proposal</button>
              <div class="form-note">Requires 100 XP to create proposals</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      console.log('üåô NocturneSwap Professional DEX - Starting...');
      
      // Global State
      let app = {
        wallet: {
          connected: false,
          provider: null,
          publicKey: null,
          balances: {}
        },
        tokens: {},
        pools: {},
        settings: {
          slippage: 1,
          deadline: 20
        },
        currentSection: 'swap',
        connection: null,
        isLoading: false
      };
      
      // Token Configuration
      const TOKENS = {
        SOL: {
          symbol: 'SOL',
          name: 'Solana',
          decimals: 9,
          mint: 'So11111111111111111111111111111111111111112',
          logo: '‚òÄÔ∏è'
        },
        USDC: {
          symbol: 'USDC',
          name: 'USD Coin',
          decimals: 6,
          mint: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',
          logo: 'üíµ'
        },
        USDT: {
          symbol: 'USDT',
          name: 'Tether USD',
          decimals: 6,
          mint: 'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB',
          logo: 'üí¥'
        },
        RAY: {
          symbol: 'RAY',
          name: 'Raydium',
          decimals: 6,
          mint: '4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R',
          logo: 'üåä'
        }
      };
      
      // Initialize Solana Connection
      function initializeSolana() {
        try {
          app.connection = new solanaWeb3.Connection(
            'https://api.mainnet-beta.solana.com',
            'confirmed'
          );
          console.log('‚úÖ Solana connection initialized');
        } catch (error) {
          console.error('‚ùå Failed to initialize Solana connection:', error);
        }
      }
      
      // Wallet Functions
      async function connectWallet(provider) {
        try {
          setLoadingState(true);
          
          let walletProvider;
          if (provider === 'phantom') {
            if (!window.solana?.isPhantom) {
              updateStatus('Phantom wallet not found. Please install Phantom.');
              window.open('https://phantom.app/', '_blank');
              return;
            }
            walletProvider = window.solana;
          } else if (provider === 'solflare') {
            if (!window.solflare?.isSolflare) {
              updateStatus('Solflare wallet not found. Please install Solflare.');
              window.open('https://solflare.com/', '_blank');
              return;
            }
            walletProvider = window.solflare;
          }
          
          const response = await walletProvider.connect();
          
          app.wallet.connected = true;
          app.wallet.provider = walletProvider;
          app.wallet.publicKey = response.publicKey;
          
          updateWalletUI(provider === 'phantom' ? 'Phantom' : 'Solflare');
          await updateBalances();
          
          console.log(`‚úÖ ${provider} wallet connected:`, response.publicKey.toString());
          
        } catch (error) {
          console.error(`‚ùå Failed to connect ${provider}:`, error);
          updateStatus(`Failed to connect ${provider} wallet`);
        } finally {
          setLoadingState(false);
        }
      }
      
      // Update Wallet UI
      function updateWalletUI(walletName) {
        document.getElementById('walletName').textContent = walletName;
        document.getElementById('walletAddress').textContent = 
          app.wallet.publicKey.toString().slice(0, 4) + '...' + 
          app.wallet.publicKey.toString().slice(-4);
        
        document.getElementById('walletStatus').style.display = 'none';
        document.getElementById('walletInfo').style.display = 'block';
        
        document.getElementById('swapButton').disabled = false;
        document.getElementById('swapButton').textContent = 'Review Swap';
        
        updateStatus('Wallet connected successfully!');
      }
      
      // Update Token Balances
      async function updateBalances() {
        if (!app.connection || !app.wallet.publicKey) return;
        
        try {
          // Get SOL balance
          const solBalance = await app.connection.getBalance(app.wallet.publicKey);
          const solAmount = (solBalance / solanaWeb3.LAMPORTS_PER_SOL).toFixed(4);
          
          app.wallet.balances.SOL = solAmount;
          document.getElementById('solBalance').textContent = `${solAmount} SOL`;
          
          // Mock other token balances (in production, would fetch real token accounts)
          app.wallet.balances.USDC = '1,234.56';
          app.wallet.balances.USDT = '567.89';
          app.wallet.balances.RAY = '12.34';
          
          document.getElementById('usdcBalance').textContent = `${app.wallet.balances.USDC} USDC`;
          
          updateTokenBalances();
          
        } catch (error) {
          console.error('‚ùå Failed to update balances:', error);
        }
      }
      
      // Update Token Balance Display
      function updateTokenBalances() {
        const fromToken = document.getElementById('fromTokenSelect').querySelector('span').textContent;
        const toToken = document.getElementById('toTokenSelect').querySelector('span').textContent;
        
        const fromBalance = app.wallet.balances[fromToken] || '0';
        const toBalance = app.wallet.balances[toToken] || '0';
        
        document.getElementById('fromBalance').textContent = `Balance: ${fromBalance} ${fromToken}`;
        document.getElementById('toBalance').textContent = `Balance: ${toBalance} ${toToken}`;
      }
      
      // Calculate Swap
      async function calculateSwap() {
        const fromAmount = parseFloat(document.getElementById('fromAmount').value) || 0;
        const fromToken = document.getElementById('fromTokenSelect').querySelector('span').textContent;
        const toToken = document.getElementById('toTokenSelect').querySelector('span').textContent;
        
        if (fromAmount <= 0) {
          document.getElementById('toAmount').value = '';
          updateSwapDetails(0, fromToken, toToken);
          return;
        }
        
        try {
          // Mock price calculation (in production, would use Jupiter API)
          const mockPrices = {
            'SOL/USDC': 142.35,
            'USDC/SOL': 1 / 142.35,
            'SOL/USDT': 142.10,
            'USDT/SOL': 1 / 142.10,
            'USDC/USDT': 0.999,
            'USDT/USDC': 1.001,
            'RAY/SOL': 0.0234,
            'SOL/RAY': 1 / 0.0234
          };
          
          const pair = `${fromToken}/${toToken}`;
          const rate = mockPrices[pair] || 1;
          const priceImpact = Math.min(fromAmount * 0.01, 5); // Mock price impact
          const adjustedRate = rate * (1 - priceImpact / 100);
          const toAmount = (fromAmount * adjustedRate).toFixed(6);
          
          document.getElementById('toAmount').value = toAmount;
          updateSwapDetails(fromAmount, fromToken, toToken, rate, priceImpact, toAmount);
          
        } catch (error) {
          console.error('‚ùå Failed to calculate swap:', error);
          updateStatus('Error calculating swap rate');
        }
      }
      
      // Update Swap Details
      function updateSwapDetails(fromAmount, fromToken, toToken, rate = 0, priceImpact = 0, toAmount = 0) {
        if (fromAmount <= 0) {
          document.getElementById('exchangeRate').textContent = '--';
          document.getElementById('priceImpact').textContent = '--';
          document.getElementById('minReceived').textContent = '--';
          return;
        }
        
        document.getElementById('exchangeRate').textContent = 
          `1 ${fromToken} = ${rate.toFixed(4)} ${toToken}`;
        
        const impactElement = document.getElementById('priceImpact');
        impactElement.textContent = `${priceImpact.toFixed(2)}%`;
        impactElement.className = 'detail-value ' + (priceImpact > 3 ? 'negative' : priceImpact > 1 ? 'neutral' : 'positive');
        
        const minReceived = (toAmount * (1 - app.settings.slippage / 100)).toFixed(6);
        document.getElementById('minReceived').textContent = `${minReceived} ${toToken}`;
        
        if (app.wallet.connected) {
          updateStatus(`Ready to swap ${fromAmount} ${fromToken} for ~${toAmount} ${toToken}`);
        }
      }
      
      // Perform Swap
      async function performSwap() {
        if (!app.wallet.connected) {
          updateStatus('Please connect your wallet first');
          return;
        }
        
        const fromAmount = parseFloat(document.getElementById('fromAmount').value) || 0;
        const fromToken = document.getElementById('fromTokenSelect').querySelector('span').textContent;
        const toToken = document.getElementById('toTokenSelect').querySelector('span').textContent;
        
        if (fromAmount <= 0) {
          updateStatus('Please enter a valid amount');
          return;
        }
        
        try {
          setLoadingState(true);
          document.getElementById('swapButton').classList.add('loading');
          updateStatus('Preparing swap transaction...');
          
          // Simulate transaction processing
          await new Promise(resolve => setTimeout(resolve, 2000));
          
          // In production, this would:
          // 1. Get Jupiter quote
          // 2. Create swap transaction
          // 3. Sign and send transaction
          // 4. Wait for confirmation
          
          updateStatus('Swap completed successfully! üéâ');
          
          // Reset form
          document.getElementById('fromAmount').value = '';
          document.getElementById('toAmount').value = '';
          updateSwapDetails(0, fromToken, toToken);
          
          // Update balances
          await updateBalances();
          
        } catch (error) {
          console.error('‚ùå Swap failed:', error);
          updateStatus('Swap failed. Please try again.');
        } finally {
          setLoadingState(false);
          document.getElementById('swapButton').classList.remove('loading');
        }
      }
      
      // Token Selection
      function selectToken(type) {
        const tokenList = Object.keys(TOKENS);
        const currentElement = document.getElementById(type === 'from' ? 'fromTokenSelect' : 'toTokenSelect');
        const currentToken = currentElement.querySelector('span').textContent;
        const currentIndex = tokenList.indexOf(currentToken);
        const nextIndex = (currentIndex + 1) % tokenList.length;
        const nextToken = tokenList[nextIndex];
        
        currentElement.querySelector('span').textContent = nextToken;
        updateTokenBalances();
        calculateSwap();
      }
      
      // Swap Tokens
      function swapTokens() {
        const fromElement = document.getElementById('fromTokenSelect').querySelector('span');
        const toElement = document.getElementById('toTokenSelect').querySelector('span');
        
        const fromToken = fromElement.textContent;
        const toToken = toElement.textContent;
        
        fromElement.textContent = toToken;
        toElement.textContent = fromToken;
        
        const fromAmount = document.getElementById('fromAmount').value;
        const toAmount = document.getElementById('toAmount').value;
        
        document.getElementById('fromAmount').value = toAmount;
        document.getElementById('toAmount').value = fromAmount;
        
        updateTokenBalances();
        calculateSwap();
      }
      
      // Navigation
      function switchSection(section) {
        // Hide all sections
        document.getElementById('swapInterface').style.display = 'none';
        document.getElementById('poolInterface').style.display = 'none';
        document.getElementById('portfolioInterface').style.display = 'none';
        document.getElementById('socialInterface').style.display = 'none';
        document.getElementById('daoInterface').style.display = 'none';
        document.getElementById('adminInterface').style.display = 'none';
        
        // Show selected section
        if (section === 'swap') {
          document.getElementById('swapInterface').style.display = 'block';
        } else if (section === 'pools') {
          document.getElementById('poolInterface').style.display = 'block';
        } else if (section === 'portfolio') {
          document.getElementById('portfolioInterface').style.display = 'block';
          updateTradingHistory();
        } else if (section === 'social') {
          document.getElementById('socialInterface').style.display = 'block';
          updateSocialData();
        } else if (section === 'dao') {
          document.getElementById('daoInterface').style.display = 'block';
          updateDAOData();
        } else if (section === 'admin') {
          document.getElementById('adminInterface').style.display = 'block';
        }
        
        // Update navigation
        document.querySelectorAll('.nav-button').forEach(btn => {
          btn.classList.remove('active');
          btn.setAttribute('aria-pressed', 'false');
        });
        const activeBtn = document.querySelector(`[data-section="${section}"]`);
        activeBtn.classList.add('active');
        activeBtn.setAttribute('aria-pressed', 'true');
        
        app.currentSection = section;
        updateStatus(`Switched to ${section} section`);
      }
      
      // Utility Functions
      function setLoadingState(loading) {
        app.isLoading = loading;
        if (loading) {
          document.getElementById('swapButton').disabled = true;
        } else {
          document.getElementById('swapButton').disabled = !app.wallet.connected;
        }
      }
      
      function updateStatus(message) {
        console.log('Status:', message);
        // In production, would update a status display
      }
      
      // Mock Data Updates
      function updateMarketStats() {
        const stats = {
          totalVolume: '$' + (Math.random() * 10000000).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          totalLiquidity: '$' + (Math.random() * 100000000).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          totalUsers: Math.floor(Math.random() * 50000) + 10000,
          totalTrades: Math.floor(Math.random() * 1000000) + 100000
        };
        
        Object.entries(stats).forEach(([key, value]) => {
          const element = document.getElementById(key);
          if (element) element.textContent = value;
        });
      }
      
      // Update Trading History
      function updateTradingHistory() {
        const mockTrades = [
          { pair: 'SOL ‚Üí USDC', amount: (Math.random() * 10).toFixed(2) + ' SOL', time: Math.floor(Math.random() * 60) + ' mins ago' },
          { pair: 'USDC ‚Üí RAY', amount: (Math.random() * 100).toFixed(0) + ' USDC', time: Math.floor(Math.random() * 120) + ' mins ago' },
          { pair: 'RAY ‚Üí SOL', amount: (Math.random() * 200).toFixed(0) + ' RAY', time: Math.floor(Math.random() * 180) + ' mins ago' },
          { pair: 'SOL ‚Üí SRM', amount: (Math.random() * 5).toFixed(2) + ' SOL', time: Math.floor(Math.random() * 240) + ' mins ago' },
          { pair: 'USDC ‚Üí SOL', amount: (Math.random() * 150).toFixed(0) + ' USDC', time: Math.floor(Math.random() * 300) + ' mins ago' }
        ];
        
        const historyElement = document.getElementById('tradingHistory');
        if (historyElement) {
          historyElement.innerHTML = mockTrades.map(trade => 
            `<div class="trade-entry">
              <div class="trade-pair">${trade.pair}</div>
              <div class="trade-amount">${trade.amount}</div>
              <div class="trade-time">${trade.time}</div>
            </div>`
          ).join('');
        }
        
        // Update portfolio stats
        const portfolioValue = document.getElementById('portfolioValue');
        const portfolioChange = document.getElementById('portfolioChange');
        if (portfolioValue) portfolioValue.textContent = '$' + (Math.random() * 10000 + 1000).toFixed(2);
        if (portfolioChange) {
          const change = (Math.random() - 0.5) * 20;
          portfolioChange.textContent = (change > 0 ? '+' : '') + change.toFixed(2) + '%';
          portfolioChange.style.color = change > 0 ? '#10b981' : '#ef4444';
        }
      }
      
      // Initialize App with Enhanced Loading
      function initializeApp() {
        try {
          // Enhanced loading sequence
          const loadingSteps = [
            { progress: 10, text: "Connecting to the void..." },
            { progress: 25, text: "Summoning Jupiter integration..." },
            { progress: 40, text: "Awakening Solana spirits..." },
            { progress: 60, text: "Channeling mystical energies..." },
            { progress: 80, text: "Preparing ritual chamber..." },
            { progress: 95, text: "Opening dimensional portal..." },
            { progress: 100, text: "Welcome to NocturneSwap..." }
          ];
          
          let stepIndex = 0;
          const progressFill = document.getElementById('progressFill');
          const progressText = document.getElementById('progressText');
          
          const updateProgress = () => {
            if (stepIndex < loadingSteps.length) {
              const step = loadingSteps[stepIndex];
              progressFill.style.width = step.progress + '%';
              progressText.textContent = step.text;
              stepIndex++;
              setTimeout(updateProgress, 300);
            } else {
              // Complete initialization
              completeInitialization();
            }
          };
          
          updateProgress();
          
        } catch (error) {
          console.error('‚ùå Failed to initialize app:', error);
        }
      }
      
      function completeInitialization() {
        try {
          initializeSolana();
          
          // Register Service Worker for PWA
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
              .then((registration) => {
                console.log('üåô Service Worker registered successfully:', registration.scope);
                
                // Check for app updates
                registration.addEventListener('updatefound', () => {
                  const newWorker = registration.installing;
                  newWorker.addEventListener('statechange', () => {
                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                      // Show update notification
                      showUpdateNotification();
                    }
                  });
                });
              })
              .catch((error) => {
                console.error('‚ùå Service Worker registration failed:', error);
              });
          }
          
          // PWA Install Prompt
          let deferredPrompt;
          window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
          });
          
          // Event listeners
          document.getElementById('connectPhantom').addEventListener('click', () => connectWallet('phantom'));
          document.getElementById('connectSolflare').addEventListener('click', () => connectWallet('solflare'));
          
          document.getElementById('fromAmount').addEventListener('input', calculateSwap);
          document.getElementById('fromTokenSelect').addEventListener('click', () => selectToken('from'));
          document.getElementById('toTokenSelect').addEventListener('click', () => selectToken('to'));
          document.getElementById('swapIcon').addEventListener('click', swapTokens);
          document.getElementById('swapButton').addEventListener('click', performSwap);
          
          // Navigation
          document.querySelectorAll('.nav-button').forEach(button => {
            button.addEventListener('click', () => {
              const section = button.getAttribute('data-section');
              switchSection(section);
            });
            
            // Add keyboard navigation
            button.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                const section = button.getAttribute('data-section');
                switchSection(section);
              }
            });
          });
          
          // Admin functions
          document.getElementById('refreshStatus').addEventListener('click', () => {
            updateStatus('System status refreshed');
          });
          
          document.getElementById('exportData').addEventListener('click', () => {
            updateStatus('Analytics data exported');
          });
          
          // Gaming-Tier Enhancements Event Listeners
          initializeGamingFeatures();
          
          // Update market stats periodically
          updateMarketStats();
          setInterval(updateMarketStats, 30000); // Update every 30 seconds
          
          // Hide loading screen
          document.getElementById('loadingScreen').style.display = 'none';
          document.getElementById('appContainer').style.display = 'block';
          
          console.log('‚úÖ NocturneSwap Professional DEX initialized');
          
        } catch (error) {
          console.error('‚ùå Failed to complete initialization:', error);
        }      }
      
      // Gaming-Tier Enhancement Functions
      function initializeGamingFeatures() {
        // Initialize XP system
        initializeXPSystem();
        
        // Theme system
        initializeThemeSystem();
        
        // Floating buttons
        initializeFloatingButtons();
        
        // Apply initial theme
        applyTheme('cult');
        
        console.log('‚úÖ Gaming-tier features initialized');
      }
      
      function initializeXPSystem() {
        let currentXP = parseInt(localStorage.getItem('nocturne_xp') || '0');
        let currentLevel = Math.floor(currentXP / 100) + 1;
        
        const cultRanks = [
          'Initiate', 'Acolyte', 'Disciple', 'Devotee', 'Mystic',
          'Shadow Walker', 'Void Speaker', 'Dark Oracle', 'Night Lord', 'Eternal Master'
        ];
        
        function updateXPDisplay() {
          const xpForCurrentLevel = (currentLevel - 1) * 100;
          const xpForNextLevel = currentLevel * 100;
          const progressXP = currentXP - xpForCurrentLevel;
          const maxProgressXP = xpForNextLevel - xpForCurrentLevel;
          const progressPercent = (progressXP / maxProgressXP) * 100;
          
          document.getElementById('xpBarFill').style.width = progressPercent + '%';
          document.getElementById('xpText').textContent = `${progressXP} / ${maxProgressXP} XP`;
          document.getElementById('levelIndicator').textContent = `Level ${currentLevel}`;
          document.getElementById('cultRank').textContent = cultRanks[Math.min(currentLevel - 1, cultRanks.length - 1)];
        }
        
        function gainXP(amount) {
          currentXP += amount;
          const newLevel = Math.floor(currentXP / 100) + 1;
          
          if (newLevel > currentLevel) {
            currentLevel = newLevel;
            showLevelUpNotification();
          }
          
          localStorage.setItem('nocturne_xp', currentXP.toString());
          updateXPDisplay();
        }
        
        function showLevelUpNotification() {
          const notification = document.createElement('div');
          notification.className = 'level-up-notification';
          notification.innerHTML = `
            <div class="level-up-content">
              <div class="level-up-title">üåü LEVEL UP! üåü</div>
              <div class="level-up-text">You've reached Level ${currentLevel}!</div>
              <div class="level-up-rank">New Rank: ${cultRanks[Math.min(currentLevel - 1, cultRanks.length - 1)]}</div>
            </div>
          `;
          notification.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff1493, #ff69b4);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 0 30px rgba(255, 20, 147, 0.8);
            animation: levelUpPulse 2s ease-in-out;
          `;
          
          document.body.appendChild(notification);
          setTimeout(() => notification.remove(), 3000);
        }
        
        // Award XP for various actions
        window.gainXP = gainXP;
        updateXPDisplay();
        
        // Auto-gain XP for activity
        setInterval(() => gainXP(1), 30000); // 1 XP every 30 seconds for engagement
      }
      
      function initializeThemeSystem() {
        const themeBtn = document.getElementById('themeBtn');
        const themeDropdown = document.getElementById('themeDropdown');
        let currentTheme = localStorage.getItem('nocturne_theme') || 'cult';
        
        // Theme dropdown toggle
        themeBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          themeDropdown.classList.toggle('show');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
          themeDropdown.classList.remove('show');
        });
        
        // Theme selection
        document.querySelectorAll('.theme-option').forEach(option => {
          option.addEventListener('click', (e) => {
            const theme = e.target.dataset.theme;
            applyTheme(theme);
            themeDropdown.classList.remove('show');
          });
        });
        
        // Apply saved theme
        applyTheme(currentTheme);
      }
      
      function applyTheme(themeName) {
        const themes = {
          cult: {
            name: 'üåô Cult',
            primary: '#ff1493',
            secondary: '#ff69b4',
            glow: '#ff1493',
            bg: '#0a0a0a'
          },
          cyber: {
            name: '‚ö° Cyber',
            primary: '#00ffff',
            secondary: '#0080ff',
            glow: '#00ffff',
            bg: '#001122'
          },
          ember: {
            name: 'üî• Ember',
            primary: '#ff6600',
            secondary: '#ff9900',
            glow: '#ff6600',
            bg: '#2a1a0a'
          }
        };
        
        const theme = themes[themeName];
        if (!theme) return;
        
        // Remove old theme classes
        document.body.classList.remove('theme-cult', 'theme-cyber', 'theme-ember');
        
        // Add new theme class
        document.body.classList.add(`theme-${themeName}`);
        
        // Update CSS variables
        document.documentElement.style.setProperty('--theme-primary', theme.primary);
        document.documentElement.style.setProperty('--theme-secondary', theme.secondary);
        document.documentElement.style.setProperty('--theme-glow', theme.glow);
        document.documentElement.style.setProperty('--theme-bg', theme.bg);
        document.documentElement.style.setProperty('--neon-pink', theme.primary);
        
        // Update theme button text
        document.getElementById('themeBtn').textContent = theme.name;
        
        // Save theme preference
        localStorage.setItem('nocturne_theme', themeName);
        
        // Award XP for theme change
        if (window.gainXP) window.gainXP(5);
        
        console.log(`‚ú® Applied ${theme.name} theme`);
      }
      
      function initializeFloatingButtons() {
        const floatingToggle = document.getElementById('floatingToggle');
        const floatingMenu = document.getElementById('floatingMenu');
        
        // Toggle floating menu
        floatingToggle.addEventListener('click', () => {
          floatingMenu.classList.toggle('show');
          floatingToggle.style.transform = floatingMenu.classList.contains('show') 
            ? 'scale(1.1) rotate(45deg)' 
            : 'scale(1) rotate(0deg)';
        });
        
        // Floating button actions
        document.getElementById('securityBtn').addEventListener('click', () => {
          showNotification('üõ°Ô∏è Security scan initiated...', 'success');
          if (window.gainXP) window.gainXP(10);
          floatingMenu.classList.remove('show');
          floatingToggle.style.transform = 'scale(1) rotate(0deg)';
        });
        
        document.getElementById('achievementsBtn').addEventListener('click', () => {
          showAchievementsModal();
          floatingMenu.classList.remove('show');
          floatingToggle.style.transform = 'scale(1) rotate(0deg)';
        });
        
        document.getElementById('helpBtn').addEventListener('click', () => {
          showNotification('‚ùì Help documentation opened', 'info');
          floatingMenu.classList.remove('show');
          floatingToggle.style.transform = 'scale(1) rotate(0deg)';
        });
      }
      
      function showAchievementsModal() {
        const modal = document.createElement('div');
        modal.className = 'achievements-modal';
        modal.innerHTML = `
          <div class="modal-content">
            <div class="modal-header">
              <h2>üèÜ Achievements</h2>
              <button class="modal-close" onclick="this.parentElement.parentElement.parentElement.remove()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="achievement-grid">
                <div class="achievement-item completed">
                  <div class="achievement-icon">üåô</div>
                  <div class="achievement-info">
                    <h3>First Steps</h3>
                    <p>Welcome to NocturneSwap</p>
                  </div>
                </div>
                <div class="achievement-item">
                  <div class="achievement-icon">üí±</div>
                  <div class="achievement-info">
                    <h3>First Swap</h3>
                    <p>Perform your first token swap</p>
                  </div>
                </div>
                <div class="achievement-item">
                  <div class="achievement-icon">üèä</div>
                  <div class="achievement-info">
                    <h3>Liquidity Provider</h3>
                    <p>Add liquidity to a pool</p>
                  </div>
                </div>
                <div class="achievement-item">
                  <div class="achievement-icon">üéØ</div>
                  <div class="achievement-info">
                    <h3>Theme Master</h3>
                    <p>Try all visual themes</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;
        
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
          backdrop-filter: blur(10px);
        `;
        
        document.body.appendChild(modal);
        if (window.gainXP) window.gainXP(5);
      }

      // PWA Functions
      function showInstallButton() {
        const installBtn = document.createElement('button');
        installBtn.textContent = 'üì± Install App';
        installBtn.className = 'install-btn glow-btn';
        installBtn.style.position = 'fixed';
        installBtn.style.bottom = '20px';
        installBtn.style.right = '20px';
        installBtn.style.zIndex = '9999';
        
        installBtn.addEventListener('click', async () => {
          if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`PWA install prompt: ${outcome}`);
            deferredPrompt = null;
            installBtn.remove();
          }
        });
        
        document.body.appendChild(installBtn);
        
        // Auto-hide after 10 seconds
        setTimeout(() => {
          if (installBtn.parentNode) {
            installBtn.remove();
          }
        }, 10000);
      }
      
      function showUpdateNotification() {
        const notification = document.createElement('div');
        notification.className = 'update-notification';
        notification.innerHTML = `
          <div class="notification-content">
            <span>üîÑ App update available!</span>
            <button onclick="location.reload()" class="update-btn">Update Now</button>
            <button onclick="this.parentNode.parentNode.remove()" class="dismiss-btn">Later</button>
          </div>
        `;
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: linear-gradient(45deg, #9d4edd, #c77dff);
          color: white;
          padding: 16px;
          border-radius: 12px;
          z-index: 10000;
          box-shadow: 0 8px 32px rgba(157, 78, 221, 0.3);
        `;
        
        document.body.appendChild(notification);
        
        // Auto-hide after 8 seconds
        setTimeout(() => {
          if (notification.parentNode) {
            notification.remove();
          }
        }, 8000);
      }

      // Gaming-Tier Theme System
      function switchTheme(theme) {
        document.body.className = `theme-${theme}`;
        localStorage.setItem('nocturne-theme', theme);
        
        // Update theme button text
        const themeBtn = document.getElementById('themeSwitcher');
        if (themeBtn) {
          const themeNames = { cult: 'üåô Cult', cyber: 'üåê Cyber', ember: 'üî• Ember' };
          themeBtn.textContent = themeNames[theme];
        }
        
        // Restart particle effects
        restartParticleEffects();
      }

      function restartParticleEffects() {
        // Remove existing embers
        document.querySelectorAll('.ember').forEach(ember => ember.remove());
        
        // Create new embers based on theme
        const theme = document.body.className.replace('theme-', '');
        createEmberEffect(theme);
      }

      function createEmberEffect(theme) {
        const colors = {
          cult: ['#ff1493', '#8e44ad', '#fff0fa'],
          cyber: ['#00fff7', '#00ff85', '#0ff'],
          ember: ['#ff6f00', '#ff1744', '#ffb300']
        };
        
        setInterval(() => {
          if (document.querySelectorAll('.ember').length < 8) {
            const ember = document.createElement('div');
            ember.className = 'ember';
            ember.style.left = Math.random() * 100 + 'vw';
            ember.style.animationDelay = Math.random() * 2 + 's';
            ember.style.animationDuration = (4 + Math.random() * 4) + 's';
            
            const themeColors = colors[theme] || colors.cult;
            const color = themeColors[Math.floor(Math.random() * themeColors.length)];
            ember.style.background = `radial-gradient(circle, ${color}, transparent)`;
            
            document.body.appendChild(ember);
            
            // Remove ember after animation
            setTimeout(() => ember.remove(), 8000);
          }
        }, 1000);
      }

      // XP and Rank System
      let currentXP = parseInt(localStorage.getItem('nocturne-xp') || '0');
      let currentRank = parseInt(localStorage.getItem('nocturne-rank') || '1');

      function updateXPDisplay() {
        const xpElement = document.getElementById('currentXP');
        const rankElement = document.getElementById('currentRank');
        const progressElement = document.getElementById('xpProgress');
        
        if (xpElement) xpElement.textContent = currentXP;
        if (rankElement) rankElement.textContent = currentRank;
        
        if (progressElement) {
          const xpForNextRank = currentRank * 1000;
          const progress = (currentXP % 1000) / 10;
          progressElement.style.width = progress + '%';
        }
      }

      function addXP(amount) {
        currentXP += amount;
        localStorage.setItem('nocturne-xp', currentXP.toString());
        
        // Check for rank up
        const newRank = Math.floor(currentXP / 1000) + 1;
        if (newRank > currentRank) {
          currentRank = newRank;
          localStorage.setItem('nocturne-rank', currentRank.toString());
          showRankUpAnimation();
        }
        
        updateXPDisplay();
      }

      function showRankUpAnimation() {
        const notification = document.createElement('div');
        notification.innerHTML = `
          <div style="text-align: center;">
            <h3>üéâ RANK UP! üéâ</h3>
            <p>You've reached Cult Rank ${currentRank}!</p>
          </div>
        `;
        notification.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: linear-gradient(45deg, #ff1493, #8e44ad);
          color: white;
          padding: 30px;
          border-radius: 15px;
          z-index: 10000;
          box-shadow: 0 0 30px #ff1493;
          animation: rankUpPulse 2s ease-in-out;
        `;
        
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 3000);
      }

      // Floating Buttons System
      function toggleFloatingMenu() {
        const menu = document.getElementById('floatingMenu');
        const isExpanded = menu.classList.contains('expanded');
        
        if (isExpanded) {
          menu.classList.remove('expanded');
        } else {
          menu.classList.add('expanded');
        }
      }

      function showAchievements() {
        const modal = document.createElement('div');
        modal.innerHTML = `
          <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üèÜ Achievements</h2>
            <div class="achievement-grid">
              <div class="achievement-item ${currentXP >= 100 ? 'unlocked' : ''}">
                <div class="achievement-icon">üåü</div>
                <div class="achievement-text">
                  <h4>First Steps</h4>
                  <p>Earn 100 XP</p>
                </div>
              </div>
              <div class="achievement-item ${currentXP >= 500 ? 'unlocked' : ''}">
                <div class="achievement-icon">üíé</div>
                <div class="achievement-text">
                  <h4>Diamond Hands</h4>
                  <p>Earn 500 XP</p>
                </div>
              </div>
              <div class="achievement-item ${currentRank >= 5 ? 'unlocked' : ''}">
                <div class="achievement-icon">üëë</div>
                <div class="achievement-text">
                  <h4>Cult Leader</h4>
                  <p>Reach Rank 5</p>
                </div>
              </div>
            </div>
          </div>
        `;
        modal.className = 'achievement-modal';
        modal.style.cssText = `
          position: fixed;
          top: 0; left: 0; width: 100%; height: 100%;
          background: rgba(0,0,0,0.8);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
        `;
        
        document.body.appendChild(modal);
      }

      // Social Features Functions
      function updateSocialData() {
        // Update profile data
        const profileXP = document.getElementById('profileXP');
        const profileTrades = document.getElementById('profileTrades');
        const profileVolume = document.getElementById('profileVolume');
        const leaderboardUserXP = document.getElementById('leaderboardUserXP');
        
        if (profileXP) profileXP.textContent = currentXP;
        if (profileTrades) profileTrades.textContent = localStorage.getItem('nocturne-trades') || '0';
        if (profileVolume) profileVolume.textContent = '$' + (localStorage.getItem('nocturne-volume') || '0');
        if (leaderboardUserXP) leaderboardUserXP.textContent = currentXP + ' XP';
        
        // Update referral data
        const referralCount = document.getElementById('referralCount');
        const referralBonus = document.getElementById('referralBonus');
        
        if (referralCount) referralCount.textContent = localStorage.getItem('nocturne-referrals') || '0';
        if (referralBonus) referralBonus.textContent = localStorage.getItem('nocturne-referral-bonus') || '0';
      }

      function copyReferralLink() {
        const referralLink = document.getElementById('referralLink');
        if (referralLink) {
          referralLink.select();
          document.execCommand('copy');
          showNotification('Referral link copied! üîó');
        }
      }

      // DAO Functions
      function updateDAOData() {
        // Calculate voting power based on XP and rank
        const baseVotes = Math.floor(currentXP / 100);
        const rankBonus = currentRank * 10;
        const activityBonus = Math.floor((localStorage.getItem('nocturne-trades') || 0) / 5);
        const totalVotes = baseVotes + rankBonus + activityBonus;
        
        const votingPower = document.getElementById('votingPower');
        const tokenVotes = document.getElementById('tokenVotes');
        const rankVotes = document.getElementById('rankVotes');
        const activityVotes = document.getElementById('activityVotes');
        
        if (votingPower) votingPower.textContent = totalVotes;
        if (tokenVotes) tokenVotes.textContent = baseVotes;
        if (rankVotes) rankVotes.textContent = rankBonus;
        if (activityVotes) activityVotes.textContent = activityBonus;
      }

      function castVote(proposalId, vote) {
        const votes = JSON.parse(localStorage.getItem('nocturne-votes') || '{}');
        
        if (votes[proposalId]) {
          showNotification('You have already voted on this proposal! üó≥Ô∏è');
          return;
        }
        
        votes[proposalId] = vote;
        localStorage.setItem('nocturne-votes', JSON.stringify(votes));
        
        // Add XP for voting
        addXP(25);
        
        showNotification(`Vote cast: ${vote === 'yes' ? 'üëç' : 'üëé'} (+25 XP)`);
        
        // Disable vote buttons for this proposal
        const proposalElement = document.querySelector(`[onclick*="${proposalId}"]`).closest('.proposal-item');
        const voteButtons = proposalElement.querySelectorAll('.vote-btn');
        voteButtons.forEach(btn => {
          btn.disabled = true;
          btn.style.opacity = '0.5';
        });
      }

      function createProposal() {
        const title = document.getElementById('proposalTitle').value;
        const description = document.getElementById('proposalDescription').value;
        
        if (!title || !description) {
          showNotification('Please fill in all fields! ‚úçÔ∏è');
          return;
        }
        
        if (currentXP < 100) {
          showNotification('You need at least 100 XP to create proposals! üìà');
          return;
        }
        
        // Save proposal (in real app, this would go to backend)
        const proposals = JSON.parse(localStorage.getItem('nocturne-proposals') || '[]');
        const newProposal = {
          id: Date.now(),
          title,
          description,
          creator: 'You',
          createdAt: new Date().toISOString(),
          votes: { yes: 0, no: 0 }
        };
        
        proposals.push(newProposal);
        localStorage.setItem('nocturne-proposals', JSON.stringify(proposals));
        
        // Clear form
        document.getElementById('proposalTitle').value = '';
        document.getElementById('proposalDescription').value = '';
        
        // Add XP for creating proposal
        addXP(50);
        
        showNotification('Proposal created successfully! üèõÔ∏è (+50 XP)');
      }

      // Advanced Trading Features
      function switchTradingMode(mode) {
        // Hide all panels
        document.getElementById('limitPanel').style.display = 'none';
        document.getElementById('dcaPanel').style.display = 'none';
        
        // Remove active class from all tabs
        document.querySelectorAll('.mode-tab').forEach(tab => {
          tab.classList.remove('active');
        });
        
        // Show selected panel and activate tab
        if (mode === 'limit') {
          document.getElementById('limitPanel').style.display = 'block';
          updateSwapButtonText('Place Limit Order');
        } else if (mode === 'dca') {
          document.getElementById('dcaPanel').style.display = 'block';
          updateDCAPreview();
          updateSwapButtonText('Start DCA');
        } else {
          updateSwapButtonText('Swap');
        }
        
        // Activate clicked tab
        document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
        
        addXP(5); // XP for exploring features
      }
      
      function updateSwapButtonText(text) {
        const swapButton = document.getElementById('swapButton');
        if (swapButton && !swapButton.disabled) {
          swapButton.textContent = text;
        }
      }
      
      function updateDCAPreview() {
        const frequency = document.getElementById('dcaFrequency').value;
        const duration = document.getElementById('dcaDuration').value;
        const amount = parseFloat(document.getElementById('fromAmount').value) || 0;
        
        let purchases = 0;
        switch(frequency) {
          case 'daily':
            purchases = duration === '1w' ? 7 : duration === '1m' ? 30 : duration === '3m' ? 90 : 180;
            break;
          case 'weekly':
            purchases = duration === '1w' ? 1 : duration === '1m' ? 4 : duration === '3m' ? 12 : 24;
            break;
          case 'monthly':
            purchases = duration === '1w' ? 0.25 : duration === '1m' ? 1 : duration === '3m' ? 3 : 6;
            break;
        }
        
        const amountPerPurchase = purchases > 0 ? (amount / purchases).toFixed(4) : 0;
        
        document.getElementById('dcaTotalPurchases').textContent = Math.floor(purchases);
        document.getElementById('dcaAmountPerPurchase').textContent = `${amountPerPurchase} SOL`;
      }
      
      // Portfolio Analytics Functions
      function exportTradingHistory() {
        const trades = [
          ['Date', 'Pair', 'Type', 'Amount', 'Value', 'PnL'],
          ['2025-07-10 14:30', 'SOL ‚Üí USDC', 'Instant Swap', '1.5 SOL', '$150.75', '+$2.50'],
          ['2025-07-10 14:15', 'USDC ‚Üí RAY', 'Limit Order', '50 USDC', '125 RAY', '-$1.20'],
          ['2025-07-10 13:45', 'RAY ‚Üí SOL', 'DCA', '100 RAY', '0.8 SOL', '+$0.85']
        ];
        
        const csvContent = trades.map(row => row.join(',')).join('\n');
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'nocturne_trading_history.csv';
        a.click();
        window.URL.revokeObjectURL(url);
        
        addXP(20);
        showNotification('Trading history exported! üìä (+20 XP)');
      }
      
      // Cult Wars Functions
      function switchCultTeam() {
        const currentTeam = localStorage.getItem('nocturne-cult-team') || 'moon-cult';
        const newTeam = currentTeam === 'moon-cult' ? 'degen-army' : 'moon-cult';
        
        localStorage.setItem('nocturne-cult-team', newTeam);
        
        const teamName = newTeam === 'moon-cult' ? 'üåô Moon Cult' : 'ü¶ç Degen Army';
        showNotification(`Switched to ${teamName}! ‚öîÔ∏è (+30 XP)`);
        
        addXP(30);
        updateCultWarsDisplay();
      }
      
      function updateCultWarsDisplay() {
        const currentTeam = localStorage.getItem('nocturne-cult-team') || 'moon-cult';
        const teamDisplay = document.querySelector('.contrib-value');
        if (teamDisplay) {
          teamDisplay.textContent = currentTeam === 'moon-cult' ? 'üåô Moon Cult' : 'ü¶ç Degen Army';
        }
        
        // Update battle timer
        const timer = document.getElementById('battleTimer');
        if (timer) {
          updateBattleTimer();
        }
      }
      
      function updateBattleTimer() {
        const endDate = new Date();
        endDate.setDate(endDate.getDate() + 2);
        endDate.setHours(endDate.getHours() + 14);
        
        const now = new Date();
        const timeLeft = endDate - now;
        
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        
        const timer = document.getElementById('battleTimer');
        if (timer) {
          timer.textContent = `${days}d ${hours}h left`;
        }
      }
      
      // Seasonal Events Functions
      function createSeasonalEvent() {
        const name = document.getElementById('eventName').value;
        const type = document.getElementById('eventType').value;
        const duration = document.getElementById('eventDuration').value;
        
        if (!name || !duration) {
          showNotification('Please fill in all event details! üìã');
          return;
        }
        
        if (currentXP < 500) {
          showNotification('You need 500 XP to create seasonal events! üìà');
          return;
        }
        
        const event = {
          id: Date.now(),
          name,
          type,
          duration: parseInt(duration),
          created: new Date().toISOString(),
          active: true
        };
        
        const events = JSON.parse(localStorage.getItem('nocturne-seasonal-events') || '[]');
        events.push(event);
        localStorage.setItem('nocturne-seasonal-events', JSON.stringify(events));
        
        // Clear form
        document.getElementById('eventName').value = '';
        document.getElementById('eventDuration').value = '';
        
        addXP(100);
        showNotification(`Seasonal event "${name}" created! üéâ (+100 XP)`);
      }
      
      // Advanced Analytics Functions
      function updateAdvancedAnalytics() {
        // Update portfolio analytics
        const trades = parseInt(localStorage.getItem('nocturne-trades') || '0');
        const volume = parseFloat(localStorage.getItem('nocturne-volume') || '0');
        
        const totalReturn = Math.floor(Math.random() * 1000) + 500; // Mock data
        const winRate = Math.floor(Math.random() * 40) + 60; // 60-100%
        const avgTradeSize = volume > 0 ? Math.floor(volume / trades) : 0;
        const bestTrade = Math.floor(Math.random() * 200) + 50;
        
        const totalReturnEl = document.getElementById('totalReturn');
        const winRateEl = document.getElementById('winRate');
        const avgTradeSizeEl = document.getElementById('avgTradeSize');
        const bestTradeEl = document.getElementById('bestTrade');
        
        if (totalReturnEl) totalReturnEl.textContent = `+$${totalReturn}`;
        if (winRateEl) winRateEl.textContent = `${winRate}%`;
        if (avgTradeSizeEl) avgTradeSizeEl.textContent = `$${avgTradeSize}`;
        if (bestTradeEl) bestTradeEl.textContent = `+$${bestTrade}`;
        
        // Update cult wars user stats
        const userVolume = Math.floor(Math.random() * 5000);
        const userRank = Math.floor(Math.random() * 100) + 1;
        
        const volumeEl = document.getElementById('userBattleVolume');
        const rankEl = document.getElementById('userBattleRank');
        
        if (volumeEl) volumeEl.textContent = `$${userVolume}`;
        if (rankEl) rankEl.textContent = `#${userRank}`;
      }
      
      // Enhanced initialization
      function initializeAdvancedFeatures() {
        // Initialize trading mode listeners
        const dcaFrequency = document.getElementById('dcaFrequency');
        const dcaDuration = document.getElementById('dcaDuration');
        
        if (dcaFrequency && dcaDuration) {
          dcaFrequency.addEventListener('change', updateDCAPreview);
          dcaDuration.addEventListener('change', updateDCAPreview);
        }
        
        // Initialize cult wars
        updateCultWarsDisplay();
        
        // Update analytics
        updateAdvancedAnalytics();
        
        // Start battle timer updates
        setInterval(updateBattleTimer, 60000); // Update every minute
        
        // Periodic analytics updates
        setInterval(updateAdvancedAnalytics, 30000); // Update every 30 seconds
        
        console.log('‚ú® Advanced features initialized');
      }

      // Initialize Gaming Features
      function initializeGamingFeatures() {
        // Load saved theme
        const savedTheme = localStorage.getItem('nocturne-theme') || 'cult';
        switchTheme(savedTheme);
        
        // Initialize XP display
        updateXPDisplay();
        
        // Add event listeners
        const themeSwitcher = document.getElementById('themeSwitcher');
        const themeDropdown = document.getElementById('themeDropdown');
        
        if (themeSwitcher && themeDropdown) {
          themeSwitcher.addEventListener('click', (e) => {
            e.stopPropagation();
            themeDropdown.classList.toggle('show');
          });
          
          document.addEventListener('click', () => {
            themeDropdown.classList.remove('show');
          });
        }
        
        // Theme option listeners
        document.querySelectorAll('.theme-option').forEach(option => {
          option.addEventListener('click', (e) => {
            const theme = e.target.dataset.theme;
            switchTheme(theme);
            themeDropdown.classList.remove('show');
          });
        });
        
        // Floating menu listener
        const floatingToggle = document.getElementById('floatingToggle');
        if (floatingToggle) {
          floatingToggle.addEventListener('click', toggleFloatingMenu);
        }
        
        // Achievement button listener
        const achievementBtn = document.getElementById('achievementBtn');
        if (achievementBtn) {
          achievementBtn.addEventListener('click', showAchievements);
        }
        
        // Social features listeners
        const copyReferralBtn = document.getElementById('copyReferralLink');
        if (copyReferralBtn) {
          copyReferralBtn.addEventListener('click', copyReferralLink);
        }
        
        // DAO features listeners
        const createProposalBtn = document.getElementById('createProposal');
        if (createProposalBtn) {
          createProposalBtn.addEventListener('click', createProposal);
        }
        
        // Advanced Trading Features listeners
        document.querySelectorAll('.mode-tab').forEach(tab => {
          tab.addEventListener('click', (e) => {
            switchTradingMode(e.target.dataset.mode);
          });
        });
        
        // Advanced features listeners
        const exportTradesBtn = document.getElementById('exportTrades');
        if (exportTradesBtn) {
          exportTradesBtn.addEventListener('click', exportTradingHistory);
        }
        
        const switchTeamBtn = document.getElementById('switchTeam');
        if (switchTeamBtn) {
          switchTeamBtn.addEventListener('click', switchCultTeam);
        }
        
        // Seasonal events listeners
        const createEventBtn = document.getElementById('createEvent');
        if (createEventBtn) {
          createEventBtn.addEventListener('click', createSeasonalEvent);
        }
        
        // Add XP on interactions
        document.addEventListener('click', (e) => {
          if (e.target.classList.contains('glow-btn') || 
              e.target.classList.contains('primary-btn') ||
              e.target.id === 'swapButton') {
            addXP(Math.floor(Math.random() * 20) + 10);
          }
        });
        
        // Create fog layer
        const fogLayer = document.createElement('div');
        fogLayer.className = 'fog-layer';
        document.body.appendChild(fogLayer);
        
        // Start particle effects
        createEmberEffect(savedTheme);
      }
      
      // Start app when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          setTimeout(() => {
            initializeApp();
            initializeGamingFeatures();
            initializeAdvancedFeatures();
          }, 2000); // Show loading for 2 seconds
        });
      } else {
        setTimeout(() => {
          initializeApp();
          initializeGamingFeatures();
          initializeAdvancedFeatures();
        }, 2000);
      }
      
    </script>
  </body>
</html>
